<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NeuroRead — Sign In</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Syne:wght@700;800;900&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;1,9..40,300&family=Space+Mono:wght@400;700&family=Lexend:wght@300;400;500;600&family=Atkinson+Hyperlegible:wght@400;700&display=swap');

        :root {
            --bg: #070b14;
            --bg2: #0d1526;
            --card: rgba(13, 21, 38, 0.82);
            --border: rgba(100, 180, 255, 0.13);
            --border-h: rgba(100, 180, 255, 0.35);
            --cyan: #38bdf8;
            --cyan-glow: rgba(56, 189, 248, 0.22);
            --violet: #a78bfa;
            --violet-glow: rgba(167, 139, 250, 0.18);
            --emerald: #34d399;
            --gold: #fbbf24;
            --text: #e8f0fe;
            --muted: #7a91b4;
            --error: #f87171;
            --error-bg: rgba(248, 113, 113, 0.1);
            --success: #34d399;
            --r: 20px;
            --t: 0.3s cubic-bezier(.4, 0, .2, 1);
            --font-body: 'DM Sans', system-ui, sans-serif;
            --font-size: 16px;
            --panel-left-bg: linear-gradient(145deg, #0a1628 0%, #0d1f3c 50%, #091220 100%);
            --accent1: #38bdf8;
            --accent2: #a78bfa;
        }

        /* THEMES */
        body.theme-emerald {
            --cyan: #34d399;
            --violet: #06b6d4;
            --accent1: #34d399;
            --accent2: #06b6d4;
        }

        body.theme-rose {
            --cyan: #f472b6;
            --violet: #fb7185;
            --accent1: #f472b6;
            --accent2: #fb7185;
            --panel-left-bg: linear-gradient(145deg, #1a0a14 0%, #2a0d1e 50%, #180810 100%);
        }

        body.theme-amber {
            --cyan: #fbbf24;
            --violet: #f97316;
            --accent1: #fbbf24;
            --accent2: #f97316;
            --panel-left-bg: linear-gradient(145deg, #1a1208 0%, #2a1c0a 50%, #140e04 100%);
        }

        body.theme-mono {
            --cyan: #e8f0fe;
            --violet: #7a91b4;
            --accent1: #e8f0fe;
            --accent2: #7a91b4;
            filter: saturate(0.15);
        }

        /* FONTS */
        body.font-lexend {
            --font-body: 'Lexend', sans-serif;
        }

        body.font-mono {
            --font-body: 'Space Mono', monospace;
        }

        body.font-dyslexia {
            --font-body: 'Atkinson Hyperlegible', sans-serif;
            letter-spacing: 0.05em;
            line-height: 1.85;
        }

        /* font size controlled via JS on html element */
        body.focus .blobs,
        body.focus .grid-lines {
            opacity: 0.25;
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            font-size: var(--font-size, 16px);
        }

        body {
            font-family: var(--font-body, 'DM Sans', sans-serif);
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            display: grid;
            place-items: center;
            overflow: hidden;
            position: relative;
            transition: filter 0.4s;
        }

        /* BLOBS */
        .blobs {
            position: fixed;
            inset: 0;
            z-index: 0;
            pointer-events: none;
            overflow: hidden;
        }

        .blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(90px);
            mix-blend-mode: screen;
            animation: blobDrift 20s ease-in-out infinite;
        }

        .blob-1 {
            width: 650px;
            height: 650px;
            background: radial-gradient(circle, rgba(56, 189, 248, 0.25) 0%, transparent 70%);
            top: -200px;
            left: -150px;
            animation-delay: 0s;
        }

        .blob-2 {
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(167, 139, 250, 0.22) 0%, transparent 70%);
            bottom: -120px;
            right: -100px;
            animation-delay: -7s;
        }

        .blob-3 {
            width: 380px;
            height: 380px;
            background: radial-gradient(circle, rgba(52, 211, 153, 0.18) 0%, transparent 70%);
            top: 55%;
            left: 45%;
            animation-delay: -13s;
        }

        @keyframes blobDrift {

            0%,
            100% {
                transform: translate(0, 0) scale(1);
            }

            25% {
                transform: translate(40px, -55px) scale(1.08);
            }

            50% {
                transform: translate(-25px, 35px) scale(0.93);
            }

            75% {
                transform: translate(55px, 20px) scale(1.05);
            }
        }

        .grid-lines {
            position: fixed;
            inset: 0;
            z-index: 0;
            pointer-events: none;
            background-image: linear-gradient(rgba(56, 189, 248, 0.04) 1px, transparent 1px), linear-gradient(90deg, rgba(56, 189, 248, 0.04) 1px, transparent 1px);
            background-size: 60px 60px;
            mask-image: radial-gradient(ellipse 80% 80% at 50% 50%, black 0%, transparent 100%);
        }

        /* SCENE */
        .scene {
            position: relative;
            z-index: 2;
            width: min(980px, 96vw);
            min-height: min(640px, 96vh);
            display: grid;
            grid-template-columns: 1fr 420px;
            gap: 0;
            border-radius: 28px;
            overflow: hidden;
            box-shadow: 0 0 0 1px var(--border), 0 40px 120px rgba(0, 0, 0, 0.7), 0 0 80px rgba(56, 189, 248, 0.06);
            animation: sceneIn 0.9s cubic-bezier(.16, 1, .3, 1) both;
        }

        @keyframes sceneIn {
            from {
                opacity: 0;
                transform: translateY(40px) scale(0.96);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* LEFT PANEL */
        .panel-left {
            background: var(--panel-left-bg);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding: 48px;
        }

        .panel-left::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(ellipse 70% 50% at 30% 40%, rgba(56, 189, 248, 0.08) 0%, transparent 60%), radial-gradient(ellipse 50% 60% at 80% 70%, rgba(167, 139, 250, 0.07) 0%, transparent 60%);
        }

        /* ─── NEURAL NETWORK CANVAS ─── */
        #neural-canvas {
            position: absolute;
            inset: 0;
            z-index: 1;
            pointer-events: none;
        }

        /* Floating chips */
        .data-chips {
            position: absolute;
            inset: 0;
            pointer-events: none;
            z-index: 3;
        }

        .chip {
            position: absolute;
            background: rgba(13, 21, 38, 0.85);
            border: 1px solid var(--border);
            border-radius: 100px;
            padding: 6px 14px;
            font-size: 0.72rem;
            font-weight: 500;
            color: var(--muted);
            backdrop-filter: blur(8px);
            white-space: nowrap;
            animation: chipFloat 6s ease-in-out infinite;
        }

        .chip .dot {
            display: inline-block;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            margin-right: 6px;
            vertical-align: middle;
        }

        .chip-1 {
            top: 12%;
            left: 6%;
            animation-delay: 0s;
        }

        .chip-2 {
            top: 22%;
            right: 5%;
            animation-delay: -2s;
        }

        .chip-3 {
            bottom: 32%;
            left: 5%;
            animation-delay: -4s;
        }

        .chip-4 {
            bottom: 20%;
            right: 7%;
            animation-delay: -1s;
        }

        @keyframes chipFloat {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .left-text {
            position: relative;
            z-index: 4;
        }

        .left-tagline {
            font-family: 'Syne', sans-serif;
            font-size: clamp(1.4rem, 2.5vw, 1.8rem);
            font-weight: 800;
            line-height: 1.25;
            color: #fff;
            margin-bottom: 14px;
        }

        .left-tagline em {
            font-style: normal;
            background: linear-gradient(90deg, var(--accent1), var(--accent2));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .left-desc {
            font-size: 0.88rem;
            color: var(--muted);
            line-height: 1.7;
            max-width: 280px;
        }

        .left-stats {
            display: flex;
            gap: 24px;
            margin-top: 28px;
        }

        .stat-item {
            text-align: left;
        }

        .stat-num {
            font-family: 'Syne', sans-serif;
            font-weight: 900;
            font-size: 1.4rem;
            background: linear-gradient(135deg, var(--accent1), var(--emerald));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-lbl {
            font-size: 0.72rem;
            color: var(--muted);
            margin-top: 2px;
        }

        /* PULSE RINGS around brain center */
        .pulse-rings {
            position: absolute;
            top: 38%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
            pointer-events: none;
        }

        .pulse-ring {
            position: absolute;
            border-radius: 50%;
            border: 1px solid;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: pulseRing 3s ease-out infinite;
        }

        .pulse-ring:nth-child(1) {
            width: 80px;
            height: 80px;
            border-color: rgba(56, 189, 248, 0.6);
            animation-delay: 0s;
        }

        .pulse-ring:nth-child(2) {
            width: 130px;
            height: 130px;
            border-color: rgba(167, 139, 250, 0.4);
            animation-delay: 0.8s;
        }

        .pulse-ring:nth-child(3) {
            width: 190px;
            height: 190px;
            border-color: rgba(56, 189, 248, 0.2);
            animation-delay: 1.6s;
        }

        @keyframes pulseRing {
            0% {
                transform: translate(-50%, -50%) scale(0.7);
                opacity: 1;
            }

            100% {
                transform: translate(-50%, -50%) scale(1.6);
                opacity: 0;
            }
        }

        /* BRAIN SVG center */
        .brain-center {
            position: absolute;
            top: 38%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 3;
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, var(--accent1), var(--accent2));
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 40px rgba(56, 189, 248, 0.5), 0 0 80px rgba(167, 139, 250, 0.25);
            animation: brainPulse 2.5s ease-in-out infinite;
        }

        @keyframes brainPulse {

            0%,
            100% {
                box-shadow: 0 0 40px rgba(56, 189, 248, 0.5), 0 0 80px rgba(167, 139, 250, 0.25);
                transform: translate(-50%, -50%) scale(1);
            }

            50% {
                box-shadow: 0 0 60px rgba(56, 189, 248, 0.7), 0 0 120px rgba(167, 139, 250, 0.4);
                transform: translate(-50%, -50%) scale(1.07);
            }
        }

        /* RIGHT PANEL */
        .panel-right {
            background: var(--card);
            backdrop-filter: blur(28px) saturate(1.6);
            border-left: 1px solid var(--border);
            padding: 48px 40px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .panel-right::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle at top right, rgba(167, 139, 250, 0.12), transparent 70%);
            pointer-events: none;
        }

        /* LOGO */
        .logo {
            font-family: 'Syne', sans-serif;
            font-weight: 900;
            font-size: 2rem;
            letter-spacing: -0.05em;
            margin-bottom: 6px;
            position: relative;
            display: inline-block;
            cursor: default;
            user-select: none;
        }

        .logo-neuro {
            color: var(--accent1);
            text-shadow: 0 0 30px rgba(56, 189, 248, 0.5);
            display: inline;
        }

        .logo-read {
            color: var(--accent2);
            text-shadow: 0 0 30px rgba(167, 139, 250, 0.5);
            display: inline;
        }

        .logo.glitch {
            animation: glitchLoop 8s infinite;
        }

        .logo.glitch::before,
        .logo.glitch::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            font-family: 'Syne', sans-serif;
            font-weight: 900;
            font-size: 2rem;
            letter-spacing: -0.05em;
            opacity: 0;
        }

        .logo.glitch::before {
            color: var(--accent1);
            clip-path: polygon(0 20%, 100% 20%, 100% 40%, 0 40%);
            animation: glitchTop 8s infinite;
        }

        .logo.glitch::after {
            color: var(--accent2);
            clip-path: polygon(0 60%, 100% 60%, 100% 80%, 0 80%);
            animation: glitchBot 8s infinite;
        }

        @keyframes glitchLoop {

            0%,
            90%,
            100% {
                transform: none;
            }

            92% {
                transform: skew(-1deg);
            }

            94% {
                transform: skew(1deg) translateX(2px);
            }

            96% {
                transform: none;
            }
        }

        @keyframes glitchTop {

            0%,
            89%,
            100% {
                opacity: 0;
                transform: none;
            }

            90% {
                opacity: 0.7;
                transform: translateX(-4px);
            }

            92% {
                opacity: 0.7;
                transform: translateX(4px);
            }

            94% {
                opacity: 0;
            }
        }

        @keyframes glitchBot {

            0%,
            91%,
            100% {
                opacity: 0;
                transform: none;
            }

            92% {
                opacity: 0.6;
                transform: translateX(4px);
            }

            94% {
                opacity: 0.6;
                transform: translateX(-3px);
            }

            96% {
                opacity: 0;
            }
        }

        .logo-badge {
            display: inline-block;
            vertical-align: top;
            margin-top: 4px;
            margin-left: 6px;
            font-family: 'DM Sans', sans-serif;
            font-size: 0.58rem;
            font-weight: 700;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            background: linear-gradient(135deg, var(--accent1), var(--accent2));
            color: var(--bg);
            padding: 2px 7px;
            border-radius: 100px;
        }

        .logo-sub {
            font-size: 0.82rem;
            color: var(--muted);
            font-weight: 300;
            margin-bottom: 32px;
            letter-spacing: 0.01em;
        }

        /* TABS */
        .tab-row {
            display: flex;
            gap: 0;
            margin-bottom: 28px;
            background: rgba(255, 255, 255, 0.04);
            border-radius: 12px;
            padding: 4px;
            border: 1px solid var(--border);
        }

        .tab-btn {
            flex: 1;
            padding: 9px 16px;
            border: none;
            background: transparent;
            font-family: var(--font-body);
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--muted);
            border-radius: 9px;
            cursor: pointer;
            transition: var(--t);
            position: relative;
        }

        .tab-btn[aria-selected="true"] {
            background: linear-gradient(135deg, rgba(56, 189, 248, 0.18), rgba(167, 139, 250, 0.15));
            color: var(--text);
            box-shadow: 0 1px 8px rgba(56, 189, 248, 0.15);
        }

        .tab-btn:focus-visible {
            outline: 2px solid var(--accent1);
            outline-offset: 2px;
        }

        /* FORM */
        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
            animation: formIn 0.35s ease both;
        }

        @keyframes formIn {
            from {
                opacity: 0;
                transform: translateX(14px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .field {
            margin-bottom: 18px;
        }

        .field label {
            display: block;
            font-size: 0.78rem;
            font-weight: 500;
            color: var(--muted);
            margin-bottom: 8px;
            letter-spacing: 0.06em;
            text-transform: uppercase;
        }

        .field-wrap {
            position: relative;
        }

        .field-wrap input {
            width: 100%;
            padding: 13px 18px;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid var(--border);
            border-radius: 12px;
            font-family: var(--font-body);
            font-size: 0.95rem;
            color: var(--text);
            transition: var(--t);
            outline: none;
            caret-color: var(--accent1);
        }

        .field-wrap input::placeholder {
            color: rgba(122, 145, 180, 0.5);
        }

        .field-wrap input:focus {
            border-color: rgba(56, 189, 248, 0.5);
            background: rgba(56, 189, 248, 0.05);
            box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.08), 0 0 20px rgba(56, 189, 248, 0.06);
        }

        .field-wrap input[aria-invalid="true"] {
            border-color: rgba(248, 113, 113, 0.5);
            background: rgba(248, 113, 113, 0.05);
            box-shadow: 0 0 0 4px rgba(248, 113, 113, 0.08);
        }

        .field-wrap input[aria-invalid="false"] {
            border-color: rgba(52, 211, 153, 0.4);
        }

        .field-wrap.has-icon input {
            padding-right: 48px;
        }

        .input-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--muted);
            pointer-events: none;
            transition: var(--t);
        }

        .field-wrap input:focus~.input-icon {
            color: var(--accent1);
        }

        .toggle-pw-btn {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            color: var(--muted);
            padding: 4px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            transition: var(--t);
        }

        .toggle-pw-btn:hover {
            color: var(--accent1);
        }

        .field-wrap::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--accent1), var(--accent2));
            border-radius: 0 0 12px 12px;
            transition: width 0.4s ease, left 0.4s ease;
            transform: translateX(-50%);
        }

        .field-wrap:focus-within::after {
            width: 90%;
        }

        .field-err {
            display: none;
            margin-top: 7px;
            font-size: 0.78rem;
            color: var(--error);
            align-items: center;
            gap: 6px;
            padding: 7px 12px;
            background: var(--error-bg);
            border-radius: 8px;
            border: 1px solid rgba(248, 113, 113, 0.2);
        }

        .field-err.show {
            display: flex;
            animation: errShake 0.35s ease;
        }

        @keyframes errShake {

            0%,
            100% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-5px);
            }

            75% {
                transform: translateX(5px);
            }
        }

        .pw-meter {
            margin-top: 10px;
        }

        .pw-bars {
            display: flex;
            gap: 4px;
            margin-bottom: 5px;
        }

        .pw-bar {
            flex: 1;
            height: 3px;
            border-radius: 2px;
            background: rgba(255, 255, 255, 0.08);
            transition: background 0.4s ease;
        }

        .pw-bar.lit-weak {
            background: #f87171;
        }

        .pw-bar.lit-fair {
            background: var(--gold);
        }

        .pw-bar.lit-good {
            background: var(--accent1);
        }

        .pw-bar.lit-strong {
            background: var(--emerald);
        }

        .pw-lbl {
            font-size: 0.72rem;
            color: var(--muted);
        }

        /* SUBMIT */
        .btn-submit {
            width: 100%;
            margin-top: 8px;
            padding: 15px 24px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-family: var(--font-body);
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--bg);
            background: linear-gradient(135deg, var(--accent1) 0%, var(--accent2) 100%);
            position: relative;
            overflow: hidden;
            transition: var(--t);
            box-shadow: 0 4px 24px rgba(56, 189, 248, 0.25);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-submit::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, transparent 60%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .btn-submit:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(56, 189, 248, 0.4), 0 0 60px rgba(167, 139, 250, 0.15);
        }

        .btn-submit:hover::before {
            opacity: 1;
        }

        .btn-submit:disabled {
            opacity: 0.55;
            cursor: not-allowed;
        }

        .btn-submit:focus-visible {
            outline: 3px solid var(--gold);
            outline-offset: 3px;
        }

        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.35);
            transform: scale(0);
            animation: rippleAnim 0.6s linear;
            pointer-events: none;
        }

        @keyframes rippleAnim {
            to {
                transform: scale(4.5);
                opacity: 0;
            }
        }

        .spinner {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            border: 2.5px solid rgba(0, 0, 0, 0.2);
            border-top-color: var(--bg);
            animation: spin 0.65s linear infinite;
            display: none;
            flex-shrink: 0;
        }

        .btn-submit.loading .spinner {
            display: block;
        }

        .btn-submit.loading .btn-label {
            opacity: 0.7;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* META */
        .form-meta {
            display: flex;
            justify-content: flex-end;
            margin-top: -8px;
            margin-bottom: 18px;
        }

        .link-subtle {
            font-size: 0.78rem;
            color: var(--muted);
            cursor: pointer;
            background: none;
            border: none;
            font-family: inherit;
            text-decoration: underline;
            text-underline-offset: 3px;
            transition: color 0.2s;
        }

        .link-subtle:hover {
            color: var(--accent1);
        }

        .switch-row {
            margin-top: 20px;
            text-align: center;
            font-size: 0.82rem;
            color: var(--muted);
        }

        .switch-row a {
            color: var(--accent1);
            font-weight: 600;
            text-decoration: underline;
            text-underline-offset: 3px;
            cursor: pointer;
            transition: color 0.2s;
        }

        .switch-row a:hover {
            color: var(--accent2);
        }

        /* ALERT */
        .live-alert {
            display: none;
            align-items: center;
            gap: 10px;
            padding: 12px 16px;
            border-radius: 10px;
            font-size: 0.82rem;
            font-weight: 500;
            margin-bottom: 16px;
            border: 1px solid;
            animation: alertIn 0.3s ease;
        }

        @keyframes alertIn {
            from {
                opacity: 0;
                transform: translateY(-8px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .live-alert.error {
            display: flex;
            color: var(--error);
            background: var(--error-bg);
            border-color: rgba(248, 113, 113, 0.25);
        }

        .live-alert.success {
            display: flex;
            color: var(--success);
            background: rgba(52, 211, 153, 0.08);
            border-color: rgba(52, 211, 153, 0.25);
        }

        /* DIVIDER + SSO */
        .divider {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 18px 0;
            font-size: 0.75rem;
            color: rgba(122, 145, 180, 0.5);
            letter-spacing: 0.08em;
        }

        .divider::before,
        .divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(100, 180, 255, 0.1), transparent);
        }

        .btn-sso {
            width: 100%;
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid var(--border);
            border-radius: 12px;
            font-family: var(--font-body);
            font-size: 0.88rem;
            font-weight: 500;
            color: var(--text);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: var(--t);
        }

        .btn-sso:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: var(--border-h);
        }

        /* ═══════════ SETTINGS BUTTON ═══════════ */
        .settings-trigger {
            position: fixed;
            top: 16px;
            right: 16px;
            z-index: 200;
            width: 44px;
            height: 44px;
            background: rgba(13, 21, 38, 0.9);
            border: 1px solid var(--border);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--t);
            backdrop-filter: blur(16px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
            animation: barIn 0.5s 0.3s ease both;
        }

        .settings-trigger:hover {
            border-color: var(--accent1);
            box-shadow: 0 0 20px rgba(56, 189, 248, 0.2);
        }

        @keyframes barIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .settings-trigger svg {
            transition: transform 0.5s;
        }

        .settings-trigger:hover svg {
            transform: rotate(60deg);
        }

        /* ═══════════ SETTINGS PANEL ═══════════ */
        .settings-overlay {
            position: fixed;
            inset: 0;
            z-index: 300;
            background: rgba(0, 0, 0, 0);
            pointer-events: none;
            transition: background 0.3s;
        }

        .settings-overlay.open {
            background: rgba(0, 0, 0, 0.55);
            pointer-events: all;
        }

        .settings-panel {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            width: 320px;
            z-index: 400;
            background: rgba(8, 14, 28, 0.98);
            backdrop-filter: blur(32px) saturate(1.8);
            border-left: 1px solid var(--border);
            transform: translateX(100%);
            transition: transform 0.45s cubic-bezier(.16, 1, .3, 1);
            overflow-y: auto;
            padding: 28px 24px 40px;
        }

        .settings-panel.open {
            transform: translateX(0);
        }

        .settings-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 32px;
        }

        .settings-title {
            font-family: 'Syne', sans-serif;
            font-weight: 800;
            font-size: 1.2rem;
            background: linear-gradient(90deg, var(--accent1), var(--accent2));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .settings-close {
            background: none;
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--muted);
            width: 34px;
            height: 34px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--t);
        }

        .settings-close:hover {
            color: var(--error);
            border-color: rgba(248, 113, 113, 0.4);
        }

        /* Settings sections */
        .settings-section {
            margin-bottom: 28px;
        }

        .settings-section-title {
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: var(--muted);
            margin-bottom: 14px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .settings-section-title svg {
            opacity: 0.6;
        }

        /* Theme swatches */
        .theme-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .theme-swatch {
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: var(--t);
            background: rgba(255, 255, 255, 0.03);
            position: relative;
        }

        .theme-swatch:hover {
            border-color: rgba(255, 255, 255, 0.2);
        }

        .theme-swatch.active {
            border-color: var(--accent1);
            background: rgba(56, 189, 248, 0.07);
        }

        .theme-swatch.active::after {
            content: '✓';
            position: absolute;
            top: 6px;
            right: 8px;
            font-size: 0.7rem;
            color: var(--accent1);
        }

        .swatch-preview {
            display: flex;
            gap: 4px;
            margin-bottom: 8px;
        }

        .swatch-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
        }

        .swatch-name {
            font-size: 0.76rem;
            font-weight: 500;
            color: var(--text);
        }

        .swatch-sub {
            font-size: 0.66rem;
            color: var(--muted);
            margin-top: 1px;
        }

        /* Font options */
        .font-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .font-option {
            padding: 12px 14px;
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: var(--t);
            background: rgba(255, 255, 255, 0.03);
        }

        .font-option:hover {
            border-color: rgba(255, 255, 255, 0.2);
        }

        .font-option.active {
            border-color: var(--accent1);
            background: rgba(56, 189, 248, 0.07);
        }

        .font-option-name {
            font-size: 0.82rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 2px;
        }

        .font-option-preview {
            font-size: 0.72rem;
            color: var(--muted);
        }

        .font-option[data-font="lexend"] .font-option-name {
            font-family: 'Lexend', sans-serif;
        }

        .font-option[data-font="mono"] .font-option-name {
            font-family: 'Space Mono', monospace;
        }

        .font-option[data-font="dyslexia"] .font-option-name {
            font-family: 'Atkinson Hyperlegible', sans-serif;
        }

        /* Size slider */
        .size-options {
            display: flex;
            gap: 8px;
        }

        .size-btn {
            flex: 1;
            padding: 10px 8px;
            border: 2px solid var(--border);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.03);
            color: var(--muted);
            cursor: pointer;
            font-family: var(--font-body);
            font-weight: 600;
            transition: var(--t);
            font-size: 0.8rem;
        }

        .size-btn:hover {
            border-color: rgba(255, 255, 255, 0.2);
            color: var(--text);
        }

        .size-btn.active {
            border-color: var(--accent1);
            color: var(--accent1);
            background: rgba(56, 189, 248, 0.07);
        }

        /* Toggle switches */
        .toggle-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .toggle-row:last-child {
            border-bottom: none;
        }

        .toggle-label {
            font-size: 0.84rem;
            color: var(--text);
        }

        .toggle-sub {
            font-size: 0.7rem;
            color: var(--muted);
            margin-top: 2px;
        }

        .toggle-switch {
            position: relative;
            width: 44px;
            height: 24px;
            flex-shrink: 0;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
            position: absolute;
        }

        .toggle-track {
            display: block;
            width: 44px;
            height: 24px;
            border-radius: 100px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--border);
            cursor: pointer;
            transition: var(--t);
            position: relative;
        }

        .toggle-track::after {
            content: '';
            position: absolute;
            width: 18px;
            height: 18px;
            background: #fff;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: var(--t);
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.4);
        }

        .toggle-switch input:checked+.toggle-track {
            background: linear-gradient(135deg, var(--accent1), var(--accent2));
            border-color: transparent;
        }

        .toggle-switch input:checked+.toggle-track::after {
            transform: translateX(20px);
        }

        /* Reset button */
        .btn-reset {
            width: 100%;
            padding: 11px;
            border: 1px solid rgba(248, 113, 113, 0.3);
            border-radius: 10px;
            background: rgba(248, 113, 113, 0.05);
            color: var(--error);
            font-family: var(--font-body);
            font-size: 0.82rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--t);
            margin-top: 8px;
        }

        .btn-reset:hover {
            background: rgba(248, 113, 113, 0.1);
            border-color: rgba(248, 113, 113, 0.5);
        }

        /* SR ONLY */
        .sr-only {
            position: absolute;
            left: -9999px;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }

        .skip-link {
            position: fixed;
            top: -60px;
            left: 16px;
            z-index: 9999;
            background: var(--accent1);
            color: var(--bg);
            padding: 10px 18px;
            border-radius: 0 0 10px 10px;
            font-weight: 700;
            font-size: 0.85rem;
            text-decoration: none;
            transition: top 0.2s;
        }

        .skip-link:focus {
            top: 0;
        }

        /* RESPONSIVE */
        @media (max-width:700px) {
            body {
                align-items: flex-start;
                overflow-y: auto;
            }

            .scene {
                grid-template-columns: 1fr;
                border-radius: 0;
                min-height: 100vh;
                width: 100vw;
            }

            .panel-left {
                display: none;
            }

            .panel-right {
                padding: 40px 28px;
                min-height: 100vh;
            }

            .settings-panel {
                width: 100%;
            }
        }
    </style>
</head>

<body>

    <a href="#login-email" class="skip-link">Skip to form</a>
    <div id="global-live" aria-live="polite" aria-atomic="true" class="sr-only"></div>

    <div class="blobs" aria-hidden="true">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>
    <div class="grid-lines" aria-hidden="true"></div>

    <!-- ── SETTINGS BUTTON ── -->
    <button class="settings-trigger" onclick="openSettings()" aria-label="Open settings" title="Settings">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6"
            stroke-linecap="round" stroke-linejoin="round" style="color:var(--accent1)">
            <circle cx="12" cy="12" r="3" />
            <path
                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z" />
        </svg>
    </button>

    <!-- ── SETTINGS OVERLAY ── -->
    <div class="settings-overlay" id="settings-overlay" onclick="closeSettings()"></div>

    <!-- ── SETTINGS PANEL ── -->
    <aside class="settings-panel" id="settings-panel" aria-label="Settings" role="dialog">
        <div class="settings-header">
            <span class="settings-title">⚙ Preferences</span>
            <button class="settings-close" onclick="closeSettings()" aria-label="Close settings">
                <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round">
                    <path d="M1 1l12 12M13 1L1 13" />
                </svg>
            </button>
        </div>

        <!-- THEMES -->
        <div class="settings-section">
            <div class="settings-section-title">
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                    <circle cx="6" cy="6" r="4" stroke="currentColor" stroke-width="1.4" />
                    <circle cx="6" cy="6" r="2" fill="currentColor" />
                </svg>
                Color Theme
            </div>
            <div class="theme-grid" id="theme-grid">
                <div class="theme-swatch active" data-theme="default" onclick="setTheme('default',this)">
                    <div class="swatch-preview">
                        <div class="swatch-dot" style="background:#38bdf8"></div>
                        <div class="swatch-dot" style="background:#a78bfa"></div>
                    </div>
                    <div class="swatch-name">Cyber Blue</div>
                    <div class="swatch-sub">Default</div>
                </div>
                <div class="theme-swatch" data-theme="emerald" onclick="setTheme('emerald',this)">
                    <div class="swatch-preview">
                        <div class="swatch-dot" style="background:#34d399"></div>
                        <div class="swatch-dot" style="background:#06b6d4"></div>
                    </div>
                    <div class="swatch-name">Emerald</div>
                    <div class="swatch-sub">Nature</div>
                </div>
                <div class="theme-swatch" data-theme="rose" onclick="setTheme('rose',this)">
                    <div class="swatch-preview">
                        <div class="swatch-dot" style="background:#f472b6"></div>
                        <div class="swatch-dot" style="background:#fb7185"></div>
                    </div>
                    <div class="swatch-name">Rose</div>
                    <div class="swatch-sub">Vibrant</div>
                </div>
                <div class="theme-swatch" data-theme="amber" onclick="setTheme('amber',this)">
                    <div class="swatch-preview">
                        <div class="swatch-dot" style="background:#fbbf24"></div>
                        <div class="swatch-dot" style="background:#f97316"></div>
                    </div>
                    <div class="swatch-name">Amber</div>
                    <div class="swatch-sub">Warm</div>
                </div>
            </div>
        </div>

        <!-- FONTS -->
        <div class="settings-section">
            <div class="settings-section-title">
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                    <path d="M2 10V2h8v8" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" />
                    <path d="M4 10V6h4v4" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" />
                </svg>
                Font Family
            </div>
            <div class="font-options">
                <div class="font-option active" data-font="default" onclick="setFont('default',this)">
                    <div class="font-option-name">DM Sans</div>
                    <div class="font-option-preview">Clean, modern geometric</div>
                </div>
                <div class="font-option" data-font="lexend" onclick="setFont('lexend',this)">
                    <div class="font-option-name" style="font-family:'Lexend',sans-serif">Lexend</div>
                    <div class="font-option-preview">Enhanced readability</div>
                </div>
                <div class="font-option" data-font="mono" onclick="setFont('mono',this)">
                    <div class="font-option-name" style="font-family:'Space Mono',monospace">Space Mono</div>
                    <div class="font-option-preview">Monospaced / Developer</div>
                </div>
                <div class="font-option" data-font="dyslexia" onclick="setFont('dyslexia',this)">
                    <div class="font-option-name" style="font-family:'Atkinson Hyperlegible',sans-serif">Atkinson</div>
                    <div class="font-option-preview">Dyslexia-friendly ✦</div>
                </div>
            </div>
        </div>

        <!-- FONT SIZE -->
        <div class="settings-section">
            <div class="settings-section-title">
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                    <path d="M2 9l4-6 4 6" stroke="currentColor" stroke-width="1.4" stroke-linecap="round"
                        stroke-linejoin="round" />
                    <path d="M3.5 7h5" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" />
                </svg>
                Font Size
            </div>
            <div class="size-options">
                <button class="size-btn" data-size="sm" onclick="setSize('sm',this)">A−<br><span
                        style="font-size:0.65rem;font-weight:400;opacity:0.6">Small</span></button>
                <button class="size-btn active" data-size="md" onclick="setSize('md',this)">A<br><span
                        style="font-size:0.65rem;font-weight:400;opacity:0.6">Default</span></button>
                <button class="size-btn" data-size="lg" onclick="setSize('lg',this)">A+<br><span
                        style="font-size:0.65rem;font-weight:400;opacity:0.6">Large</span></button>
                <button class="size-btn" data-size="xl" onclick="setSize('xl',this)">A++<br><span
                        style="font-size:0.65rem;font-weight:400;opacity:0.6">XL</span></button>
            </div>
        </div>

        <!-- DISPLAY TOGGLES -->
        <div class="settings-section">
            <div class="settings-section-title">
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                    <rect x="1" y="1" width="10" height="10" rx="2" stroke="currentColor" stroke-width="1.4" />
                </svg>
                Display
            </div>
            <div class="toggle-row">
                <div>
                    <div class="toggle-label">Focus Mode</div>
                    <div class="toggle-sub">Reduce background motion</div>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="toggle-focus" onchange="toggleFocus(this)" />
                    <span class="toggle-track"></span>
                </label>
            </div>
            <div class="toggle-row">
                <div>
                    <div class="toggle-label">Reduce Motion</div>
                    <div class="toggle-sub">Disable animations</div>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="toggle-motion" onchange="toggleMotion(this)" />
                    <span class="toggle-track"></span>
                </label>
            </div>
            <div class="toggle-row">
                <div>
                    <div class="toggle-label">High Contrast</div>
                    <div class="toggle-sub">Increased border visibility</div>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="toggle-contrast" onchange="toggleContrast(this)" />
                    <span class="toggle-track"></span>
                </label>
            </div>
        </div>

        <button class="btn-reset" onclick="resetAll()">↺ Reset to Defaults</button>
    </aside>

    <!-- ── MAIN SCENE ── -->
    <main class="scene" role="main" id="main-scene">

        <!-- LEFT: NEURAL ANIMATION PANEL -->
        <div class="panel-left" aria-hidden="true">
            <canvas id="neural-canvas"></canvas>

            <!-- Pulse rings behind brain -->
            <div class="pulse-rings">
                <div class="pulse-ring"></div>
                <div class="pulse-ring"></div>
                <div class="pulse-ring"></div>
            </div>

            <!-- Brain center icon -->
            <div class="brain-center" id="brain-center">
                <svg width="34" height="34" viewBox="0 0 36 36" fill="none">
                    <path
                        d="M12 10 C8 10 5 13 5 17 C5 20 7 22.5 10 23.5 C9 24.5 8 26 8 28 C8 31.5 10.5 34 14 34 L22 34 C25.5 34 28 31.5 28 28 C28 26 27 24.5 26 23.5 C29 22.5 31 20 31 17 C31 13 28 10 24 10 C23 8 21 7 18 7 C15 7 13 8 12 10 Z"
                        stroke="white" stroke-width="1.6" fill="none" stroke-linejoin="round" />
                    <path d="M12 16 Q15 14 18 16 Q21 18 24 16" stroke="white" stroke-width="1.4" fill="none"
                        stroke-linecap="round" />
                    <path d="M11 22 Q14 20 18 22 Q22 24 25 22" stroke="white" stroke-width="1.4" fill="none"
                        stroke-linecap="round" />
                    <path d="M14 28 Q16 26 18 28 Q20 30 22 28" stroke="white" stroke-width="1.4" fill="none"
                        stroke-linecap="round" />
                    <circle cx="18" cy="7" r="1.5" fill="white" opacity="0.8" />
                    <path d="M18 7 L18 10" stroke="white" stroke-width="1.4" />
                </svg>
            </div>

            <!-- EEG wave visualizer -->
            <canvas id="eeg-canvas"
                style="position:absolute;bottom:155px;left:0;right:0;width:100%;height:60px;z-index:4;opacity:0.7;"></canvas>

            <div class="data-chips">
                <div class="chip chip-1"><span class="dot" style="background:#38bdf8"></span>Neural Active</div>
                <div class="chip chip-2"><span class="dot" style="background:#a78bfa"></span>WCAG 2.1 AA</div>
                <div class="chip chip-3"><span class="dot" style="background:#34d399"></span>Dyslexia Safe</div>
                <div class="chip chip-4"><span class="dot" style="background:#fbbf24"></span>500+ Books</div>
            </div>

            <div class="left-text">
                <p class="left-tagline">Reading reimagined for <em>every mind.</em></p>
                <p class="left-desc">NeuroRead adapts to how your brain works — not the other way around. Beautifully
                    accessible. Deeply personal.</p>
                <div class="left-stats">
                    <div class="stat-item">
                        <div class="stat-num">98%</div>
                        <div class="stat-lbl">Satisfaction</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-num">4.9★</div>
                        <div class="stat-lbl">Rating</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-num">0 ads</div>
                        <div class="stat-lbl">Always</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- RIGHT: FORM PANEL -->
        <section class="panel-right" aria-label="Authentication">
            <div>
                <div class="logo glitch" data-text="NeuroRead" aria-label="NeuroRead">
                    <span class="logo-neuro">Neuro</span><span class="logo-read">Read</span><span
                        class="logo-badge">Beta</span>
                </div>
                <p class="logo-sub">Your adaptive reading companion</p>
            </div>

            <div id="form-alert" role="alert" aria-live="polite" class="live-alert"></div>

            <div class="tab-row" role="tablist" aria-label="Sign in or create account">
                <button class="tab-btn" role="tab" id="tab-login" aria-selected="true" aria-controls="form-login"
                    onclick="switchTab('login')">Sign In</button>
                <button class="tab-btn" role="tab" id="tab-reg" aria-selected="false" aria-controls="form-reg"
                    onclick="switchTab('reg')">Register</button>
            </div>

            <!-- LOGIN -->
            <form class="auth-form active" id="form-login" novalidate>
                <div class="field">
                    <label for="login-email">Email</label>
                    <div class="field-wrap has-icon">
                        <input type="email" id="login-email" autocomplete="email" required aria-required="true"
                            aria-describedby="login-email-e" placeholder="you@example.com" />
                        <span class="input-icon" aria-hidden="true"><svg width="16" height="16" viewBox="0 0 16 16"
                                fill="none">
                                <rect x="1" y="3" width="14" height="10" rx="2" stroke="currentColor"
                                    stroke-width="1.5" />
                                <path d="M1 5.5l7 4.5 7-4.5" stroke="currentColor" stroke-width="1.5"
                                    stroke-linecap="round" />
                            </svg></span>
                    </div>
                    <div class="field-err" id="login-email-e" role="alert"><svg width="13" height="13"
                            viewBox="0 0 13 13" fill="none" aria-hidden="true">
                            <circle cx="6.5" cy="6.5" r="6" stroke="currentColor" stroke-width="1.4" />
                            <path d="M6.5 4v3M6.5 9h.01" stroke="currentColor" stroke-width="1.4"
                                stroke-linecap="round" />
                        </svg><span></span></div>
                </div>
                <div class="field">
                    <label for="login-pw">Password</label>
                    <div class="field-wrap has-icon">
                        <input type="password" id="login-pw" autocomplete="current-password" required
                            aria-required="true" aria-describedby="login-pw-e" placeholder="••••••••••" />
                        <button type="button" class="toggle-pw-btn" aria-label="Show password"
                            onclick="togglePw('login-pw',this)">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true">
                                <ellipse cx="8" cy="8" rx="7" ry="4.5" stroke="currentColor" stroke-width="1.4" />
                                <circle cx="8" cy="8" r="2" stroke="currentColor" stroke-width="1.4" />
                            </svg>
                        </button>
                    </div>
                    <div class="field-err" id="login-pw-e" role="alert"><svg width="13" height="13" viewBox="0 0 13 13"
                            fill="none" aria-hidden="true">
                            <circle cx="6.5" cy="6.5" r="6" stroke="currentColor" stroke-width="1.4" />
                            <path d="M6.5 4v3M6.5 9h.01" stroke="currentColor" stroke-width="1.4"
                                stroke-linecap="round" />
                        </svg><span></span></div>
                </div>
                <div class="form-meta">
                    <button type="button" class="link-subtle" onclick="forgotPw()">Forgot password?</button>
                </div>
                <button type="submit" class="btn-submit" id="login-submit">
                    <div class="spinner" aria-hidden="true"></div>
                    <span class="btn-label">Sign In</span>
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true">
                        <path d="M3 8h10M9 4l4 4-4 4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"
                            stroke-linejoin="round" />
                    </svg>
                </button>

                <div class="switch-row">No account? <a role="button" tabindex="0" onclick="switchTab('reg')"
                        onkeydown="if(event.key==='Enter')switchTab('reg')">Create one free →</a></div>
            </form>

            <!-- REGISTER -->
            <form class="auth-form" id="form-reg" novalidate>
                <div class="field">
                    <label for="reg-name">Full Name</label>
                    <div class="field-wrap has-icon">
                        <input type="text" id="reg-name" autocomplete="name" required aria-required="true"
                            aria-describedby="reg-name-e" placeholder="Jane Doe" />
                        <span class="input-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <circle cx="8" cy="5" r="3" stroke="currentColor" stroke-width="1.4" />
                                <path d="M2 14c0-3.3 2.7-6 6-6s6 2.7 6 6" stroke="currentColor" stroke-width="1.4"
                                    stroke-linecap="round" />
                            </svg></span>
                    </div>
                    <div class="field-err" id="reg-name-e" role="alert"><svg width="13" height="13" viewBox="0 0 13 13"
                            fill="none">
                            <circle cx="6.5" cy="6.5" r="6" stroke="currentColor" stroke-width="1.4" />
                            <path d="M6.5 4v3M6.5 9h.01" stroke="currentColor" stroke-width="1.4"
                                stroke-linecap="round" />
                        </svg><span></span></div>
                </div>
                <div class="field">
                    <label for="reg-email">Email</label>
                    <div class="field-wrap has-icon">
                        <input type="email" id="reg-email" autocomplete="email" required aria-required="true"
                            aria-describedby="reg-email-e" placeholder="you@example.com" />
                        <span class="input-icon"><svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <rect x="1" y="3" width="14" height="10" rx="2" stroke="currentColor"
                                    stroke-width="1.5" />
                                <path d="M1 5.5l7 4.5 7-4.5" stroke="currentColor" stroke-width="1.5"
                                    stroke-linecap="round" />
                            </svg></span>
                    </div>
                    <div class="field-err" id="reg-email-e" role="alert"><svg width="13" height="13" viewBox="0 0 13 13"
                            fill="none">
                            <circle cx="6.5" cy="6.5" r="6" stroke="currentColor" stroke-width="1.4" />
                            <path d="M6.5 4v3M6.5 9h.01" stroke="currentColor" stroke-width="1.4"
                                stroke-linecap="round" />
                        </svg><span></span></div>
                </div>
                <div class="field">
                    <label for="reg-pw">Password</label>
                    <div class="field-wrap has-icon">
                        <input type="password" id="reg-pw" autocomplete="new-password" required aria-required="true"
                            aria-describedby="reg-pw-e reg-pw-strength" placeholder="Min. 8 characters"
                            oninput="pwStrength(this.value)" />
                        <button type="button" class="toggle-pw-btn" aria-label="Show password"
                            onclick="togglePw('reg-pw',this)">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <ellipse cx="8" cy="8" rx="7" ry="4.5" stroke="currentColor" stroke-width="1.4" />
                                <circle cx="8" cy="8" r="2" stroke="currentColor" stroke-width="1.4" />
                            </svg>
                        </button>
                    </div>
                    <div class="pw-meter" id="reg-pw-strength" aria-live="polite">
                        <div class="pw-bars">
                            <div class="pw-bar" id="bar1"></div>
                            <div class="pw-bar" id="bar2"></div>
                            <div class="pw-bar" id="bar3"></div>
                            <div class="pw-bar" id="bar4"></div>
                        </div>
                        <span class="pw-lbl" id="pw-lbl">Enter a password</span>
                    </div>
                    <div class="field-err" id="reg-pw-e" role="alert"><svg width="13" height="13" viewBox="0 0 13 13"
                            fill="none">
                            <circle cx="6.5" cy="6.5" r="6" stroke="currentColor" stroke-width="1.4" />
                            <path d="M6.5 4v3M6.5 9h.01" stroke="currentColor" stroke-width="1.4"
                                stroke-linecap="round" />
                        </svg><span></span></div>
                </div>
                <div class="field">
                    <label for="reg-confirm">Confirm Password</label>
                    <div class="field-wrap has-icon">
                        <input type="password" id="reg-confirm" autocomplete="new-password" required
                            aria-required="true" aria-describedby="reg-confirm-e" placeholder="Repeat password"
                            oninput="liveConfirm()" />
                        <button type="button" class="toggle-pw-btn" aria-label="Show confirm password"
                            onclick="togglePw('reg-confirm',this)">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <ellipse cx="8" cy="8" rx="7" ry="4.5" stroke="currentColor" stroke-width="1.4" />
                                <circle cx="8" cy="8" r="2" stroke="currentColor" stroke-width="1.4" />
                            </svg>
                        </button>
                    </div>
                    <div class="field-err" id="reg-confirm-e" role="alert"><svg width="13" height="13"
                            viewBox="0 0 13 13" fill="none">
                            <circle cx="6.5" cy="6.5" r="6" stroke="currentColor" stroke-width="1.4" />
                            <path d="M6.5 4v3M6.5 9h.01" stroke="currentColor" stroke-width="1.4"
                                stroke-linecap="round" />
                        </svg><span></span></div>
                </div>
                <button type="submit" class="btn-submit" id="reg-submit">
                    <div class="spinner" aria-hidden="true"></div>
                    <span class="btn-label">Create Account</span>
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M3 8h10M9 4l4 4-4 4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"
                            stroke-linejoin="round" />
                    </svg>
                </button>
                <div class="switch-row">Already a member? <a role="button" tabindex="0" onclick="switchTab('login')"
                        onkeydown="if(event.key==='Enter')switchTab('login')">← Sign in</a></div>
            </form>
        </section>
    </main>

    <script>
        /* ══════════════════════════════════════════════
           NEURAL NETWORK ANIMATION
        ══════════════════════════════════════════════ */
        (function () {
            const canvas = document.getElementById('neural-canvas');
            const ctx = canvas.getContext('2d');
            let W, H, nodes = [], t = 0;
            let animating = true;

            // Neuron node
            class Node {
                constructor() {
                    this.reset(true);
                }
                reset(init) {
                    this.x = Math.random() * W;
                    this.y = Math.random() * H;
                    this.r = Math.random() * 3 + 1.5;
                    this.vx = (Math.random() - 0.5) * 0.3;
                    this.vy = (Math.random() - 0.5) * 0.3;
                    this.alpha = Math.random();
                    this.pulse = Math.random() * Math.PI * 2;
                    this.pulseSpeed = 0.02 + Math.random() * 0.03;
                    this.firing = false;
                    this.fireTime = 0;
                    this.type = Math.random() < 0.15 ? 'hub' : 'neuron'; // some hub nodes
                    if (this.type === 'hub') this.r = Math.random() * 5 + 4;
                    // random fire
                    this.nextFire = Math.random() * 300;
                }
                update() {
                    this.x += this.vx;
                    this.y += this.vy;
                    this.pulse += this.pulseSpeed;
                    if (this.x < -20) this.x = W + 20;
                    if (this.x > W + 20) this.x = -20;
                    if (this.y < -20) this.y = H + 20;
                    if (this.y > H + 20) this.y = -20;

                    // random firing
                    this.nextFire--;
                    if (this.nextFire <= 0) {
                        this.firing = true;
                        this.fireTime = 0;
                        this.nextFire = 200 + Math.random() * 400;
                    }
                    if (this.firing) {
                        this.fireTime++;
                        if (this.fireTime > 40) this.firing = false;
                    }
                }
                draw(ctx, accent1, accent2) {
                    const pulse = 0.5 + 0.5 * Math.sin(this.pulse);
                    const alpha = 0.4 + pulse * 0.6;
                    const r = this.r + (this.firing ? (1 - this.fireTime / 40) * 4 : 0);

                    if (this.type === 'hub') {
                        // glow ring
                        const grad = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, r * 4);
                        grad.addColorStop(0, `rgba(56,189,248,${alpha * 0.3})`);
                        grad.addColorStop(1, 'transparent');
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, r * 4, 0, Math.PI * 2);
                        ctx.fillStyle = grad;
                        ctx.fill();
                    }

                    ctx.beginPath();
                    ctx.arc(this.x, this.y, r, 0, Math.PI * 2);
                    if (this.firing) {
                        const ft = 1 - this.fireTime / 40;
                        ctx.fillStyle = `rgba(56,189,248,${ft})`;
                        ctx.shadowColor = '#38bdf8';
                        ctx.shadowBlur = 15 * ft;
                    } else {
                        ctx.fillStyle = this.type === 'hub'
                            ? `rgba(167,139,250,${alpha * 0.9})`
                            : `rgba(56,189,248,${alpha * 0.7})`;
                        ctx.shadowBlur = 0;
                    }
                    ctx.fill();
                    ctx.shadowBlur = 0;
                }
            }

            // Signal pulse traveling along edge
            const signals = [];
            class Signal {
                constructor(from, to) {
                    this.from = from; this.to = to;
                    this.p = 0; this.speed = 0.012 + Math.random() * 0.015;
                    this.color = Math.random() < 0.5 ? '#38bdf8' : '#a78bfa';
                }
                update() { this.p += this.speed; return this.p < 1; }
                draw(ctx) {
                    const x = this.from.x + (this.to.x - this.from.x) * this.p;
                    const y = this.from.y + (this.to.y - this.from.y) * this.p;
                    const alpha = Math.sin(this.p * Math.PI);
                    ctx.beginPath();
                    ctx.arc(x, y, 2.5, 0, Math.PI * 2);
                    ctx.fillStyle = this.color.replace(')', `,${alpha})`).replace('rgb', 'rgba');
                    ctx.shadowColor = this.color;
                    ctx.shadowBlur = 8;
                    ctx.fill();
                    ctx.shadowBlur = 0;
                }
            }

            function resize() {
                const el = canvas.parentElement;
                W = canvas.width = el.offsetWidth;
                H = canvas.height = el.offsetHeight;
            }

            function init() {
                resize();
                nodes = Array.from({ length: 55 }, () => new Node());
            }

            let signalTimer = 0;
            function draw() {
                if (!animating) return;
                ctx.clearRect(0, 0, W, H);
                t++;

                // Draw edges between nearby nodes
                for (let i = 0; i < nodes.length; i++) {
                    for (let j = i + 1; j < nodes.length; j++) {
                        const a = nodes[i], b = nodes[j];
                        const dx = a.x - b.x, dy = a.y - b.y;
                        const dist = Math.sqrt(dx * dx + dy * dy);
                        const maxDist = a.type === 'hub' || b.type === 'hub' ? 160 : 110;
                        if (dist < maxDist) {
                            const alpha = (1 - dist / maxDist) * 0.35;
                            ctx.beginPath();
                            ctx.moveTo(a.x, a.y);
                            ctx.lineTo(b.x, b.y);
                            const grad = ctx.createLinearGradient(a.x, a.y, b.x, b.y);
                            grad.addColorStop(0, `rgba(56,189,248,${alpha})`);
                            grad.addColorStop(1, `rgba(167,139,250,${alpha})`);
                            ctx.strokeStyle = grad;
                            ctx.lineWidth = 0.8;
                            ctx.stroke();
                        }
                    }
                }

                // Update and draw nodes
                nodes.forEach(n => {
                    n.update();
                    n.draw(ctx);
                });

                // Signals
                signalTimer++;
                if (signalTimer > 30) {
                    signalTimer = 0;
                    // pick random firing node, send signal to nearest
                    const firing = nodes.filter(n => n.firing);
                    if (firing.length > 0) {
                        const src = firing[Math.floor(Math.random() * firing.length)];
                        let best = null, bestD = 999;
                        nodes.forEach(n => {
                            if (n === src) return;
                            const dx = n.x - src.x, dy = n.y - src.y, d = Math.sqrt(dx * dx + dy * dy);
                            if (d < 130 && d < bestD) { bestD = d; best = n; }
                        });
                        if (best) signals.push(new Signal(src, best));
                    }
                }

                for (let i = signals.length - 1; i >= 0; i--) {
                    if (!signals[i].update()) { signals.splice(i, 1); continue; }
                    signals[i].draw(ctx);
                }

                requestAnimationFrame(draw);
            }

            window.addEventListener('resize', () => { resize(); });
            window.stopNeuralAnim = () => { animating = false; ctx.clearRect(0, 0, W, H); };
            window.startNeuralAnim = () => { if (!animating) { animating = true; draw(); } };
            init(); draw();
        })();

        /* ══════════════════════════════════════════════
           EEG BRAINWAVE CANVAS
        ══════════════════════════════════════════════ */
        (function () {
            const canvas = document.getElementById('eeg-canvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            let t = 0, animating = true;
            function resize() {
                canvas.width = canvas.offsetWidth * window.devicePixelRatio || 500;
                canvas.height = 60;
            }
            resize();
            window.addEventListener('resize', resize);

            function draw() {
                if (!animating) { return; }
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                const W = canvas.width, H = canvas.height;
                t += 0.05;

                // Multi-frequency brainwave
                ctx.beginPath();
                for (let x = 0; x <= W; x++) {
                    const nx = x / W;
                    const y = H / 2
                        + Math.sin(nx * 12 + t) * 8
                        + Math.sin(nx * 25 + t * 1.3) * 4
                        + Math.sin(nx * 50 + t * 2) * 2
                        + (Math.random() - 0.5) * 1.5; // noise
                    if (x === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
                }
                const grad = ctx.createLinearGradient(0, 0, W, 0);
                grad.addColorStop(0, 'rgba(56,189,248,0)');
                grad.addColorStop(0.2, 'rgba(56,189,248,0.8)');
                grad.addColorStop(0.5, 'rgba(167,139,250,0.9)');
                grad.addColorStop(0.8, 'rgba(52,211,153,0.8)');
                grad.addColorStop(1, 'rgba(52,211,153,0)');
                ctx.strokeStyle = grad;
                ctx.lineWidth = 1.5;
                ctx.shadowColor = '#38bdf8';
                ctx.shadowBlur = 6;
                ctx.stroke();
                ctx.shadowBlur = 0;
                requestAnimationFrame(draw);
            }
            window.stopEEGAnim = () => { animating = false; };
            window.startEEGAnim = () => { if (!animating) { animating = true; draw(); } };
            draw();
        })();

        /* ══════════════════════════════════════════════
           3D TILT
        ══════════════════════════════════════════════ */
        (function () {
            const scene = document.querySelector('.scene');
            let bounds;
            function refresh() { bounds = scene.getBoundingClientRect(); }
            refresh();
            window.addEventListener('resize', refresh);
            document.addEventListener('mousemove', e => {
                if (!bounds) return;
                const x = e.clientX - bounds.left - bounds.width / 2;
                const y = e.clientY - bounds.top - bounds.height / 2;
                scene.style.transform = `perspective(1200px) rotateX(${(y / bounds.height) * -5}deg) rotateY(${(x / bounds.width) * 5}deg)`;
            });
            document.addEventListener('mouseleave', () => {
                scene.style.transform = 'perspective(1200px) rotateX(0) rotateY(0)';
            });
        })();

        /* ══════════════════════════════════════════════
           PARTICLE BURST
        ══════════════════════════════════════════════ */
        function burst(btn) {
            const colors = ['#38bdf8', '#a78bfa', '#34d399', '#fbbf24'];
            for (let i = 0; i < 20; i++) {
                const p = document.createElement('span');
                const angle = (i / 20) * Math.PI * 2;
                const dist = 60 + Math.random() * 50;
                const rect = btn.getBoundingClientRect();
                p.style.cssText = `position:fixed;width:6px;height:6px;border-radius:50%;background:${colors[i % 4]};left:${rect.left + rect.width / 2}px;top:${rect.top + rect.height / 2}px;pointer-events:none;z-index:9999;--tx:${Math.cos(angle) * dist}px;--ty:${Math.sin(angle) * dist}px;animation:burstP 0.8s ${i * 0.03}s ease forwards;`;
                document.body.appendChild(p);
                p.addEventListener('animationend', () => p.remove());
            }
        }
        const burstStyle = document.createElement('style');
        burstStyle.textContent = '@keyframes burstP{to{transform:translate(var(--tx),var(--ty)) scale(0);opacity:0;}}';
        document.head.appendChild(burstStyle);

        /* Ripple */
        document.querySelectorAll('.btn-submit').forEach(btn => {
            btn.addEventListener('click', function (e) {
                const r = document.createElement('span'); r.className = 'ripple';
                const rect = this.getBoundingClientRect();
                const sz = Math.max(rect.width, rect.height) * 2;
                r.style.cssText = `width:${sz}px;height:${sz}px;left:${e.clientX - rect.left - sz / 2}px;top:${e.clientY - rect.top - sz / 2}px`;
                this.appendChild(r); r.addEventListener('animationend', () => r.remove());
            });
        });

        /* ══════════════════════════════════════════════
           TABS
        ══════════════════════════════════════════════ */
        function switchTab(t) {
            ['login', 'reg'].forEach(id => {
                const sel = id === t;
                document.getElementById('tab-' + id).setAttribute('aria-selected', sel);
                document.getElementById('form-' + id).classList.toggle('active', sel);
            });
            document.getElementById('form-alert').className = 'live-alert';
        }

        /* ══════════════════════════════════════════════
           FORM HELPERS
        ══════════════════════════════════════════════ */
        function validEmail(v) { return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v); }
        function setErr(el, errId, msg) { const d = document.getElementById(errId); d.querySelector('span').textContent = msg; d.classList.add('show'); el.setAttribute('aria-invalid', 'true'); }
        function clrErr(el, errId) { document.getElementById(errId).classList.remove('show'); el.setAttribute('aria-invalid', 'false'); }
        function showAlert(type, msg) { const a = document.getElementById('form-alert'); a.textContent = msg; a.className = 'live-alert ' + type; setTimeout(() => { a.className = 'live-alert'; a.textContent = ''; }, 6000); }
        function setLoad(btn, on) { btn.disabled = on; btn.classList.toggle('loading', on); }
        const wait = ms => new Promise(r => setTimeout(r, ms));

        function togglePw(id, btn) {
            const inp = document.getElementById(id);
            const show = inp.type === 'password';
            inp.type = show ? 'text' : 'password';
            btn.setAttribute('aria-label', show ? 'Hide password' : 'Show password');
            btn.innerHTML = show
                ? `<svg width="16" height="16" viewBox="0 0 16 16" fill="none"><ellipse cx="8" cy="8" rx="7" ry="4.5" stroke="currentColor" stroke-width="1.4"/><circle cx="8" cy="8" r="2" stroke="currentColor" stroke-width="1.4"/><line x1="1" y1="1" x2="15" y2="15" stroke="currentColor" stroke-width="1.4"/></svg>`
                : `<svg width="16" height="16" viewBox="0 0 16 16" fill="none"><ellipse cx="8" cy="8" rx="7" ry="4.5" stroke="currentColor" stroke-width="1.4"/><circle cx="8" cy="8" r="2" stroke="currentColor" stroke-width="1.4"/></svg>`;
        }
        function pwStrength(v) {
            let s = 0;
            if (v.length >= 8) s++; if (/[A-Z]/.test(v)) s++; if (/[0-9]/.test(v)) s++; if (/[^A-Za-z0-9]/.test(v)) s++;
            const cls = ['', 'lit-weak', 'lit-fair', 'lit-good', 'lit-strong'];
            const lbl = ['Enter a password', 'Weak', 'Fair', 'Good', 'Strong!'];
            const cols = ['', '#f87171', '#fbbf24', '#38bdf8', '#34d399'];
            for (let i = 1; i <= 4; i++) {
                const bar = document.getElementById('bar' + i);
                bar.className = 'pw-bar ' + (v && i <= s ? cls[s] : '');
            }
            document.getElementById('pw-lbl').textContent = v ? lbl[s] : lbl[0];
            document.getElementById('pw-lbl').style.color = v ? cols[s] : '';
        }
        function liveConfirm() {
            const pw = document.getElementById('reg-pw').value;
            const cf = document.getElementById('reg-confirm');
            if (cf.value && cf.value !== pw) setErr(cf, 'reg-confirm-e', 'Passwords do not match.');
            else if (cf.value) clrErr(cf, 'reg-confirm-e');
        }
        function forgotPw() { showAlert('success', '✓ If that email exists, a reset link is on its way.'); }
        function ssoClick() { showAlert('success', 'Redirecting to Google sign-in…'); }

        /* LOGIN */
        document.getElementById('form-login').addEventListener('submit', async e => {
            e.preventDefault();
            const email = document.getElementById('login-email');
            const pw = document.getElementById('login-pw');
            let ok = true;
            if (!email.value.trim()) { setErr(email, 'login-email-e', 'Email is required.'); ok = false; }
            else if (!validEmail(email.value)) { setErr(email, 'login-email-e', 'Enter a valid email address.'); ok = false; }
            else clrErr(email, 'login-email-e');
            if (!pw.value) { setErr(pw, 'login-pw-e', 'Password is required.'); ok = false; }
            else clrErr(pw, 'login-pw-e');
            if (!ok) return;
            const btn = document.getElementById('login-submit');
            setLoad(btn, true); await wait(1800); burst(btn); setLoad(btn, false);
            showAlert('success', '✓ Welcome back! Entering NeuroRead…');
            e.target.reset();
        });

        /* REGISTER */
        document.getElementById('form-reg').addEventListener('submit', async e => {
            e.preventDefault();
            const name = document.getElementById('reg-name');
            const email = document.getElementById('reg-email');
            const pw = document.getElementById('reg-pw');
            const confirm = document.getElementById('reg-confirm');
            let ok = true;
            if (!name.value.trim() || name.value.trim().length < 2) { setErr(name, 'reg-name-e', 'Full name is required (min 2 chars).'); ok = false; }
            else clrErr(name, 'reg-name-e');
            if (!email.value.trim()) { setErr(email, 'reg-email-e', 'Email is required.'); ok = false; }
            else if (!validEmail(email.value)) { setErr(email, 'reg-email-e', 'Enter a valid email address.'); ok = false; }
            else clrErr(email, 'reg-email-e');
            if (!pw.value || pw.value.length < 8) { setErr(pw, 'reg-pw-e', 'Password must be at least 8 characters.'); ok = false; }
            else clrErr(pw, 'reg-pw-e');
            if (!confirm.value) { setErr(confirm, 'reg-confirm-e', 'Please confirm your password.'); ok = false; }
            else if (confirm.value !== pw.value) { setErr(confirm, 'reg-confirm-e', 'Passwords do not match.'); ok = false; }
            else clrErr(confirm, 'reg-confirm-e');
            if (!ok) return;
            const btn = document.getElementById('reg-submit');
            setLoad(btn, true); await wait(2000); burst(btn); setLoad(btn, false);
            showAlert('success', '✓ Account created! Welcome to NeuroRead!');
            e.target.reset(); pwStrength('');
        });

        /* Blur hooks */
        document.getElementById('login-email').addEventListener('blur', function () {
            if (!this.value) setErr(this, 'login-email-e', 'Email is required.');
            else if (!validEmail(this.value)) setErr(this, 'login-email-e', 'Enter a valid email.');
            else clrErr(this, 'login-email-e');
        });
        document.getElementById('login-pw').addEventListener('blur', function () {
            if (!this.value) setErr(this, 'login-pw-e', 'Password is required.');
            else clrErr(this, 'login-pw-e');
        });

        /* ══════════════════════════════════════════════
           SETTINGS PANEL
        ══════════════════════════════════════════════ */
        function openSettings() {
            document.getElementById('settings-panel').classList.add('open');
            document.getElementById('settings-overlay').classList.add('open');
        }
        function closeSettings() {
            document.getElementById('settings-panel').classList.remove('open');
            document.getElementById('settings-overlay').classList.remove('open');
        }

        function setTheme(theme, el) {
            const themes = ['default', 'emerald', 'rose', 'amber'];
            document.body.classList.remove(...themes.map(t => 'theme-' + t));
            if (theme !== 'default') document.body.classList.add('theme-' + theme);
            document.querySelectorAll('.theme-swatch').forEach(s => s.classList.toggle('active', s.dataset.theme === theme));
        }

        function setFont(font, el) {
            const fonts = ['lexend', 'mono', 'dyslexia'];
            document.body.classList.remove(...fonts.map(f => 'font-' + f));
            if (font !== 'default') document.body.classList.add('font-' + font);
            document.querySelectorAll('.font-option').forEach(o => o.classList.toggle('active', o.dataset.font === font));
        }

        function setSize(size, el) {
            const sizeMap = { sm: '13px', md: '16px', lg: '19px', xl: '22px' };
            document.documentElement.style.fontSize = sizeMap[size] || '16px';
            document.querySelectorAll('.size-btn').forEach(b => b.classList.toggle('active', b.dataset.size === size));
        }

        function toggleFocus(el) {
            document.body.classList.toggle('focus', el.checked);
        }

        function toggleMotion(el) {
            if (el.checked) {
                window.stopNeuralAnim && window.stopNeuralAnim();
                window.stopEEGAnim && window.stopEEGAnim();
                document.body.style.setProperty('--t', '0s');
            } else {
                window.startNeuralAnim && window.startNeuralAnim();
                window.startEEGAnim && window.startEEGAnim();
                document.body.style.removeProperty('--t');
            }
        }

        function toggleContrast(el) {
            if (el.checked) {
                document.documentElement.style.setProperty('--border', 'rgba(100,180,255,0.4)');
                document.documentElement.style.setProperty('--muted', '#a0b8d8');
            } else {
                document.documentElement.style.removeProperty('--border');
                document.documentElement.style.removeProperty('--muted');
            }
        }

        function resetAll() {
            // Theme
            const themes = ['emerald', 'rose', 'amber'];
            document.body.classList.remove(...themes.map(t => 'theme-' + t));
            document.querySelectorAll('.theme-swatch').forEach(s => s.classList.toggle('active', s.dataset.theme === 'default'));
            // Font
            const fonts = ['lexend', 'mono', 'dyslexia'];
            document.body.classList.remove(...fonts.map(f => 'font-' + f));
            document.querySelectorAll('.font-option').forEach(o => o.classList.toggle('active', o.dataset.font === 'default'));
            // Size
            document.documentElement.style.fontSize = '16px';
            document.querySelectorAll('.size-btn').forEach(b => b.classList.toggle('active', b.dataset.size === 'md'));
            // Toggles
            ['toggle-focus', 'toggle-motion', 'toggle-contrast'].forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.checked = false;
                    if (id === 'toggle-focus') document.body.classList.remove('focus');
                    if (id === 'toggle-motion') { window.startNeuralAnim && window.startNeuralAnim(); window.startEEGAnim && window.startEEGAnim(); document.body.style.removeProperty('--t'); }
                    if (id === 'toggle-contrast') { document.documentElement.style.removeProperty('--border'); document.documentElement.style.removeProperty('--muted'); }
                }
            });
            document.documentElement.style.removeProperty('--border');
            document.documentElement.style.removeProperty('--muted');
        }
    </script>
</body>

</html>