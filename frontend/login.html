<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NeuroRead — Welcome</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
        href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800;900&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;1,9..40,300&family=Space+Mono:wght@400;700&family=Lexend:wght@300;400;500;600&family=Atkinson+Hyperlegible:wght@400;700&display=swap"
        rel="stylesheet" />
    <style>
        :root {
            --bg: #060a12;
            --bg2: #0b1120;
            --card: rgba(11, 17, 32, 0.88);
            --border: rgba(100, 180, 255, 0.13);
            --border-h: rgba(100, 180, 255, 0.38);
            --cyan: #38bdf8;
            --violet: #a78bfa;
            --emerald: #34d399;
            --gold: #fbbf24;
            --text: #e8f0fe;
            --muted: #7a91b4;
            --error: #f87171;
            --error-bg: rgba(248, 113, 113, 0.09);
            --success: #34d399;
            --font-body: 'DM Sans', sans-serif;
            --t: 0.3s cubic-bezier(.4, 0, .2, 1);
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            font-size: 16px;
        }

        body {
            font-family: var(--font-body);
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            display: grid;
            place-items: center;
            overflow-x: hidden;
            position: relative;
        }

        /* ── BACKGROUND ── */
        .bg-blobs {
            position: fixed;
            inset: 0;
            z-index: 0;
            pointer-events: none;
            overflow: hidden;
        }

        .blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(100px);
            mix-blend-mode: screen;
            animation: blobDrift 22s ease-in-out infinite;
        }

        .blob-1 {
            width: 700px;
            height: 700px;
            background: radial-gradient(circle, rgba(56, 189, 248, 0.22) 0%, transparent 70%);
            top: -200px;
            left: -180px;
            animation-delay: 0s;
        }

        .blob-2 {
            width: 520px;
            height: 520px;
            background: radial-gradient(circle, rgba(167, 139, 250, 0.2) 0%, transparent 70%);
            bottom: -140px;
            right: -120px;
            animation-delay: -8s;
        }

        .blob-3 {
            width: 360px;
            height: 360px;
            background: radial-gradient(circle, rgba(52, 211, 153, 0.14) 0%, transparent 70%);
            top: 50%;
            left: 48%;
            animation-delay: -14s;
        }

        @keyframes blobDrift {

            0%,
            100% {
                transform: translate(0, 0) scale(1);
            }

            33% {
                transform: translate(50px, -60px) scale(1.07);
            }

            66% {
                transform: translate(-30px, 40px) scale(0.94);
            }
        }

        .grid-overlay {
            position: fixed;
            inset: 0;
            z-index: 0;
            pointer-events: none;
            background-image: linear-gradient(rgba(56, 189, 248, 0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(56, 189, 248, 0.03) 1px, transparent 1px);
            background-size: 56px 56px;
            mask-image: radial-gradient(ellipse 85% 85% at 50% 50%, black 0%, transparent 100%);
        }

        /* ── SCENE ── */
        .scene {
            position: relative;
            z-index: 2;
            width: min(1000px, 96vw);
            min-height: min(660px, 94vh);
            display: grid;
            grid-template-columns: 1.1fr 420px;
            border-radius: 28px;
            overflow: hidden;
            box-shadow: 0 0 0 1px var(--border), 0 48px 140px rgba(0, 0, 0, 0.75), 0 0 80px rgba(56, 189, 248, 0.05);
            animation: sceneIn 0.85s cubic-bezier(.16, 1, .3, 1) both;
        }

        @keyframes sceneIn {
            from {
                opacity: 0;
                transform: translateY(36px) scale(0.97);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* ── LEFT PANEL ── */
        .panel-left {
            background: linear-gradient(145deg, #091222 0%, #0e1f3a 50%, #080f1a 100%);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding: 52px;
        }

        .panel-left::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(ellipse 70% 50% at 30% 38%, rgba(56, 189, 248, 0.08) 0%, transparent 60%), radial-gradient(ellipse 50% 60% at 80% 70%, rgba(167, 139, 250, 0.07) 0%, transparent 60%);
        }

        #neural-canvas {
            position: absolute;
            inset: 0;
            z-index: 1;
            pointer-events: none;
        }

        /* Pulse rings */
        .pulse-rings {
            position: absolute;
            top: 37%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
            pointer-events: none;
        }

        .pulse-ring {
            position: absolute;
            border-radius: 50%;
            border: 1px solid;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: pulseRing 3.2s ease-out infinite;
        }

        .pulse-ring:nth-child(1) {
            width: 76px;
            height: 76px;
            border-color: rgba(56, 189, 248, 0.65);
            animation-delay: 0s;
        }

        .pulse-ring:nth-child(2) {
            width: 126px;
            height: 126px;
            border-color: rgba(167, 139, 250, 0.4);
            animation-delay: 0.9s;
        }

        .pulse-ring:nth-child(3) {
            width: 182px;
            height: 182px;
            border-color: rgba(56, 189, 248, 0.18);
            animation-delay: 1.8s;
        }

        @keyframes pulseRing {
            0% {
                transform: translate(-50%, -50%) scale(0.72);
                opacity: 1;
            }

            100% {
                transform: translate(-50%, -50%) scale(1.65);
                opacity: 0;
            }
        }

        .brain-icon {
            position: absolute;
            top: 37%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 3;
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, #38bdf8, #a78bfa);
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 40px rgba(56, 189, 248, 0.5), 0 0 80px rgba(167, 139, 250, 0.22);
            animation: brainPulse 2.6s ease-in-out infinite;
        }

        @keyframes brainPulse {

            0%,
            100% {
                box-shadow: 0 0 40px rgba(56, 189, 248, 0.5), 0 0 80px rgba(167, 139, 250, 0.22);
                transform: translate(-50%, -50%) scale(1);
            }

            50% {
                box-shadow: 0 0 60px rgba(56, 189, 248, 0.72), 0 0 120px rgba(167, 139, 250, 0.36);
                transform: translate(-50%, -50%) scale(1.07);
            }
        }

        /* EEG */
        #eeg-canvas {
            position: absolute;
            bottom: 160px;
            left: 0;
            right: 0;
            width: 100%;
            height: 58px;
            z-index: 4;
            opacity: 0.65;
        }

        /* Chips */
        .data-chips {
            position: absolute;
            inset: 0;
            pointer-events: none;
            z-index: 3;
        }

        .chip {
            position: absolute;
            background: rgba(10, 17, 34, 0.85);
            border: 1px solid var(--border);
            border-radius: 100px;
            padding: 6px 14px;
            font-size: 0.71rem;
            font-weight: 500;
            color: var(--muted);
            backdrop-filter: blur(8px);
            white-space: nowrap;
            animation: chipFloat 6s ease-in-out infinite;
        }

        .chip .dot {
            display: inline-block;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            margin-right: 6px;
            vertical-align: middle;
        }

        .chip-1 {
            top: 11%;
            left: 7%;
            animation-delay: 0s;
        }

        .chip-2 {
            top: 21%;
            right: 6%;
            animation-delay: -2s;
        }

        .chip-3 {
            bottom: 30%;
            left: 6%;
            animation-delay: -4s;
        }

        .chip-4 {
            bottom: 19%;
            right: 8%;
            animation-delay: -1s;
        }

        @keyframes chipFloat {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        /* Left text */
        .left-text {
            position: relative;
            z-index: 4;
        }

        .left-tagline {
            font-family: 'Syne', sans-serif;
            font-size: clamp(1.4rem, 2.4vw, 1.9rem);
            font-weight: 800;
            line-height: 1.25;
            color: #fff;
            margin-bottom: 14px;
        }

        .left-tagline em {
            font-style: normal;
            background: linear-gradient(90deg, #38bdf8, #a78bfa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .left-desc {
            font-size: 0.87rem;
            color: var(--muted);
            line-height: 1.72;
            max-width: 290px;
        }

        .left-stats {
            display: flex;
            gap: 26px;
            margin-top: 28px;
        }

        .stat-num {
            font-family: 'Syne', sans-serif;
            font-weight: 900;
            font-size: 1.4rem;
            background: linear-gradient(135deg, #38bdf8, #34d399);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-lbl {
            font-size: 0.71rem;
            color: var(--muted);
            margin-top: 2px;
        }

        /* ── RIGHT PANEL ── */
        .panel-right {
            background: var(--card);
            backdrop-filter: blur(28px) saturate(1.6);
            border-left: 1px solid var(--border);
            padding: 44px 40px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .panel-right::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 220px;
            height: 220px;
            background: radial-gradient(circle at top right, rgba(167, 139, 250, 0.1), transparent 70%);
            pointer-events: none;
        }

        /* Logo */
        .logo {
            font-family: 'Syne', sans-serif;
            font-weight: 900;
            font-size: 1.95rem;
            letter-spacing: -0.05em;
            margin-bottom: 4px;
            display: inline-block;
            cursor: default;
            user-select: none;
            position: relative;
            animation: glitchLoop 9s infinite;
        }

        .logo::before,
        .logo::after {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            font-family: 'Syne', sans-serif;
            font-weight: 900;
            font-size: 1.95rem;
            letter-spacing: -0.05em;
            opacity: 0;
        }

        .logo::before {
            color: #38bdf8;
            clip-path: polygon(0 20%, 100% 20%, 100% 40%, 0 40%);
            animation: glitchTop 9s infinite;
        }

        .logo::after {
            color: #a78bfa;
            clip-path: polygon(0 60%, 100% 60%, 100% 80%, 0 80%);
            animation: glitchBot 9s infinite;
        }

        @keyframes glitchLoop {

            0%,
            88%,
            100% {
                transform: none;
            }

            90% {
                transform: skew(-1deg);
            }

            93% {
                transform: skew(1deg) translateX(2px);
            }

            96% {
                transform: none;
            }
        }

        @keyframes glitchTop {

            0%,
            87%,
            100% {
                opacity: 0;
                transform: none;
            }

            88% {
                opacity: 0.7;
                transform: translateX(-4px);
            }

            91% {
                opacity: 0.7;
                transform: translateX(4px);
            }

            93% {
                opacity: 0;
            }
        }

        @keyframes glitchBot {

            0%,
            89%,
            100% {
                opacity: 0;
                transform: none;
            }

            90% {
                opacity: 0.6;
                transform: translateX(4px);
            }

            93% {
                opacity: 0.6;
                transform: translateX(-3px);
            }

            95% {
                opacity: 0;
            }
        }

        .logo-neuro {
            color: #38bdf8;
            text-shadow: 0 0 28px rgba(56, 189, 248, 0.5);
        }

        .logo-read {
            color: #a78bfa;
            text-shadow: 0 0 28px rgba(167, 139, 250, 0.5);
        }

        .logo-badge {
            display: inline-block;
            vertical-align: top;
            margin-top: 5px;
            margin-left: 6px;
            font-family: 'DM Sans', sans-serif;
            font-size: 0.57rem;
            font-weight: 700;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            background: linear-gradient(135deg, #38bdf8, #a78bfa);
            color: var(--bg);
            padding: 2px 7px;
            border-radius: 100px;
        }

        .logo-sub {
            font-size: 0.81rem;
            color: var(--muted);
            font-weight: 300;
            margin-bottom: 26px;
        }

        /* API status */
        .api-status {
            display: inline-flex;
            align-items: center;
            gap: 7px;
            font-size: 0.69rem;
            color: var(--muted);
            margin-bottom: 18px;
        }

        .api-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--muted);
        }

        .api-dot.online {
            background: var(--emerald);
            box-shadow: 0 0 6px var(--emerald);
        }

        .api-dot.offline {
            background: var(--error);
            box-shadow: 0 0 6px var(--error);
        }

        /* Global alert */
        .form-alert {
            display: none;
            align-items: center;
            gap: 10px;
            padding: 11px 15px;
            border-radius: 10px;
            font-size: 0.81rem;
            font-weight: 500;
            margin-bottom: 14px;
            border: 1px solid;
            animation: alertIn 0.28s ease;
        }

        @keyframes alertIn {
            from {
                opacity: 0;
                transform: translateY(-7px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .form-alert.error {
            display: flex;
            color: var(--error);
            background: var(--error-bg);
            border-color: rgba(248, 113, 113, 0.25);
        }

        .form-alert.success {
            display: flex;
            color: var(--success);
            background: rgba(52, 211, 153, 0.07);
            border-color: rgba(52, 211, 153, 0.25);
        }

        /* Tabs */
        .tab-row {
            display: flex;
            gap: 0;
            margin-bottom: 24px;
            background: rgba(255, 255, 255, 0.04);
            border-radius: 12px;
            padding: 4px;
            border: 1px solid var(--border);
        }

        .tab-btn {
            flex: 1;
            padding: 9px 16px;
            border: none;
            background: transparent;
            font-family: var(--font-body);
            font-size: 0.84rem;
            font-weight: 500;
            color: var(--muted);
            border-radius: 9px;
            cursor: pointer;
            transition: var(--t);
        }

        .tab-btn[aria-selected="true"] {
            background: linear-gradient(135deg, rgba(56, 189, 248, 0.17), rgba(167, 139, 250, 0.14));
            color: var(--text);
            box-shadow: 0 1px 8px rgba(56, 189, 248, 0.13);
        }

        .tab-btn:focus-visible {
            outline: 2px solid #38bdf8;
            outline-offset: 2px;
        }

        /* Forms */
        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
            animation: formIn 0.32s ease both;
        }

        @keyframes formIn {
            from {
                opacity: 0;
                transform: translateX(12px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .field {
            margin-bottom: 16px;
        }

        .field label {
            display: block;
            font-size: 0.77rem;
            font-weight: 500;
            color: var(--muted);
            margin-bottom: 7px;
            letter-spacing: 0.06em;
            text-transform: uppercase;
        }

        .field-wrap {
            position: relative;
        }

        .field-wrap input {
            width: 100%;
            padding: 12px 18px;
            padding-right: 46px;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid var(--border);
            border-radius: 11px;
            font-family: var(--font-body);
            font-size: 0.93rem;
            color: var(--text);
            transition: var(--t);
            outline: none;
            caret-color: #38bdf8;
        }

        .field-wrap input::placeholder {
            color: rgba(122, 145, 180, 0.45);
        }

        .field-wrap input:focus {
            border-color: rgba(56, 189, 248, 0.5);
            background: rgba(56, 189, 248, 0.04);
            box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.07), 0 0 20px rgba(56, 189, 248, 0.05);
        }

        .field-wrap input[aria-invalid="true"] {
            border-color: rgba(248, 113, 113, 0.5);
            background: rgba(248, 113, 113, 0.04);
        }

        .field-wrap input[aria-invalid="false"] {
            border-color: rgba(52, 211, 153, 0.35);
        }

        .field-wrap::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #38bdf8, #a78bfa);
            border-radius: 0 0 11px 11px;
            transition: width 0.4s ease, left 0.4s ease;
            transform: translateX(-50%);
        }

        .field-wrap:focus-within::after {
            width: 88%;
        }

        .input-icon {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--muted);
            pointer-events: none;
            transition: var(--t);
        }

        .field-wrap input:focus~.input-icon {
            color: #38bdf8;
        }

        .toggle-pw-btn {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            color: var(--muted);
            padding: 4px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            transition: var(--t);
        }

        .toggle-pw-btn:hover {
            color: #38bdf8;
        }

        /* Field error */
        .field-err {
            display: none;
            margin-top: 6px;
            font-size: 0.77rem;
            color: var(--error);
            align-items: center;
            gap: 6px;
            padding: 7px 11px;
            background: var(--error-bg);
            border-radius: 8px;
            border: 1px solid rgba(248, 113, 113, 0.18);
        }

        .field-err.show {
            display: flex;
            animation: errShake 0.32s ease;
        }

        @keyframes errShake {

            0%,
            100% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-5px);
            }

            75% {
                transform: translateX(5px);
            }
        }

        /* Password meter */
        .pw-meter {
            margin-top: 9px;
        }

        .pw-bars {
            display: flex;
            gap: 4px;
            margin-bottom: 5px;
        }

        .pw-bar {
            flex: 1;
            height: 3px;
            border-radius: 2px;
            background: rgba(255, 255, 255, 0.07);
            transition: background 0.4s;
        }

        .pw-bar.weak {
            background: #f87171;
        }

        .pw-bar.fair {
            background: var(--gold);
        }

        .pw-bar.good {
            background: #38bdf8;
        }

        .pw-bar.strong {
            background: var(--emerald);
        }

        .pw-lbl {
            font-size: 0.71rem;
            color: var(--muted);
        }

        /* Forgot / meta */
        .form-meta {
            display: flex;
            justify-content: flex-end;
            margin: -6px 0 14px;
        }

        .link-subtle {
            font-size: 0.77rem;
            color: var(--muted);
            cursor: pointer;
            background: none;
            border: none;
            font-family: inherit;
            text-decoration: underline;
            text-underline-offset: 3px;
            transition: color 0.2s;
        }

        .link-subtle:hover {
            color: #38bdf8;
        }

        /* Submit button */
        .btn-submit {
            width: 100%;
            margin-top: 6px;
            padding: 14px 24px;
            border: none;
            border-radius: 11px;
            cursor: pointer;
            font-family: var(--font-body);
            font-size: 0.93rem;
            font-weight: 600;
            color: #060a12;
            background: linear-gradient(135deg, #38bdf8 0%, #a78bfa 100%);
            position: relative;
            overflow: hidden;
            transition: var(--t);
            box-shadow: 0 4px 22px rgba(56, 189, 248, 0.24);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-submit::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, transparent 60%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .btn-submit:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(56, 189, 248, 0.38), 0 0 55px rgba(167, 139, 250, 0.14);
        }

        .btn-submit:hover::before {
            opacity: 1;
        }

        .btn-submit:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-submit:focus-visible {
            outline: 3px solid var(--gold);
            outline-offset: 3px;
        }

        .spinner {
            width: 17px;
            height: 17px;
            border-radius: 50%;
            border: 2.5px solid rgba(0, 0, 0, 0.18);
            border-top-color: #060a12;
            animation: spin 0.65s linear infinite;
            display: none;
            flex-shrink: 0;
        }

        .btn-submit.loading .spinner {
            display: block;
        }

        .btn-submit.loading .btn-label {
            opacity: 0.7;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.33);
            transform: scale(0);
            animation: rippleAnim 0.6s linear;
            pointer-events: none;
        }

        @keyframes rippleAnim {
            to {
                transform: scale(4.5);
                opacity: 0;
            }
        }

        /* Switch row */
        .switch-row {
            margin-top: 18px;
            text-align: center;
            font-size: 0.81rem;
            color: var(--muted);
        }

        .switch-row a {
            color: #38bdf8;
            font-weight: 600;
            text-decoration: underline;
            text-underline-offset: 3px;
            cursor: pointer;
            transition: color 0.2s;
        }

        .switch-row a:hover {
            color: #a78bfa;
        }

        /* Skip link & SR */
        .skip-link {
            position: fixed;
            top: -60px;
            left: 16px;
            z-index: 9999;
            background: #38bdf8;
            color: #060a12;
            padding: 10px 18px;
            border-radius: 0 0 10px 10px;
            font-weight: 700;
            font-size: 0.84rem;
            text-decoration: none;
            transition: top 0.2s;
        }

        .skip-link:focus {
            top: 0;
        }

        .sr-only {
            position: absolute;
            left: -9999px;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }

        /* Settings trigger */
        .settings-trigger {
            position: fixed;
            top: 16px;
            right: 16px;
            z-index: 200;
            width: 44px;
            height: 44px;
            background: rgba(11, 17, 32, 0.92);
            border: 1px solid var(--border);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--t);
            backdrop-filter: blur(16px);
            box-shadow: 0 4px 18px rgba(0, 0, 0, 0.4);
            animation: barIn 0.5s 0.3s ease both;
        }

        .settings-trigger:hover {
            border-color: #38bdf8;
            box-shadow: 0 0 18px rgba(56, 189, 248, 0.2);
        }

        .settings-trigger svg {
            transition: transform 0.5s;
        }

        .settings-trigger:hover svg {
            transform: rotate(60deg);
        }

        @keyframes barIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Settings panel */
        .settings-overlay {
            position: fixed;
            inset: 0;
            z-index: 300;
            background: rgba(0, 0, 0, 0);
            pointer-events: none;
            transition: background 0.3s;
        }

        .settings-overlay.open {
            background: rgba(0, 0, 0, 0.55);
            pointer-events: all;
        }

        .settings-panel {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            width: 300px;
            z-index: 400;
            background: rgba(7, 12, 22, 0.98);
            backdrop-filter: blur(32px) saturate(1.8);
            border-left: 1px solid var(--border);
            transform: translateX(100%);
            transition: transform 0.42s cubic-bezier(.16, 1, .3, 1);
            overflow-y: auto;
            padding: 26px 22px 38px;
        }

        .settings-panel.open {
            transform: translateX(0);
        }

        .settings-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 28px;
        }

        .settings-title {
            font-family: 'Syne', sans-serif;
            font-weight: 800;
            font-size: 1.15rem;
            background: linear-gradient(90deg, #38bdf8, #a78bfa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .settings-close {
            background: none;
            border: 1px solid var(--border);
            border-radius: 9px;
            color: var(--muted);
            width: 32px;
            height: 32px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--t);
        }

        .settings-close:hover {
            color: var(--error);
            border-color: rgba(248, 113, 113, 0.4);
        }

        .s-section {
            margin-bottom: 26px;
        }

        .s-section-title {
            font-size: 0.69rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: var(--muted);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
        }

        .theme-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 9px;
        }

        .theme-swatch {
            padding: 11px;
            border: 2px solid var(--border);
            border-radius: 11px;
            cursor: pointer;
            transition: var(--t);
            background: rgba(255, 255, 255, 0.03);
            position: relative;
        }

        .theme-swatch:hover {
            border-color: rgba(255, 255, 255, 0.2);
        }

        .theme-swatch.active {
            border-color: #38bdf8;
            background: rgba(56, 189, 248, 0.06);
        }

        .theme-swatch.active::after {
            content: '✓';
            position: absolute;
            top: 5px;
            right: 7px;
            font-size: 0.68rem;
            color: #38bdf8;
        }

        .swatch-preview {
            display: flex;
            gap: 4px;
            margin-bottom: 7px;
        }

        .swatch-dot {
            width: 15px;
            height: 15px;
            border-radius: 50%;
        }

        .swatch-name {
            font-size: 0.74rem;
            font-weight: 500;
            color: var(--text);
        }

        .swatch-sub {
            font-size: 0.64rem;
            color: var(--muted);
            margin-top: 1px;
        }

        .font-options {
            display: flex;
            flex-direction: column;
            gap: 7px;
        }

        .font-option {
            padding: 11px 13px;
            border: 2px solid var(--border);
            border-radius: 11px;
            cursor: pointer;
            transition: var(--t);
            background: rgba(255, 255, 255, 0.03);
        }

        .font-option:hover {
            border-color: rgba(255, 255, 255, 0.2);
        }

        .font-option.active {
            border-color: #38bdf8;
            background: rgba(56, 189, 248, 0.06);
        }

        .font-option-name {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 2px;
        }

        .font-option-sub {
            font-size: 0.68rem;
            color: var(--muted);
        }

        .size-options {
            display: flex;
            gap: 7px;
        }

        .size-btn {
            flex: 1;
            padding: 9px 7px;
            border: 2px solid var(--border);
            border-radius: 9px;
            background: rgba(255, 255, 255, 0.03);
            color: var(--muted);
            cursor: pointer;
            font-family: var(--font-body);
            font-weight: 600;
            transition: var(--t);
            font-size: 0.78rem;
        }

        .size-btn.active {
            border-color: #38bdf8;
            color: #38bdf8;
            background: rgba(56, 189, 248, 0.06);
        }

        .toggle-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 11px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .toggle-row:last-child {
            border-bottom: none;
        }

        .toggle-lbl {
            font-size: 0.82rem;
            color: var(--text);
        }

        .toggle-sub {
            font-size: 0.68rem;
            color: var(--muted);
            margin-top: 2px;
        }

        .toggle-switch {
            position: relative;
            width: 42px;
            height: 23px;
            flex-shrink: 0;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
            position: absolute;
        }

        .toggle-track {
            display: block;
            width: 42px;
            height: 23px;
            border-radius: 100px;
            background: rgba(255, 255, 255, 0.09);
            border: 1px solid var(--border);
            cursor: pointer;
            transition: var(--t);
            position: relative;
        }

        .toggle-track::after {
            content: '';
            position: absolute;
            width: 17px;
            height: 17px;
            background: #fff;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: var(--t);
        }

        .toggle-switch input:checked+.toggle-track {
            background: linear-gradient(135deg, #38bdf8, #a78bfa);
            border-color: transparent;
        }

        .toggle-switch input:checked+.toggle-track::after {
            transform: translateX(19px);
        }

        .btn-reset {
            width: 100%;
            padding: 10px;
            border: 1px solid rgba(248, 113, 113, 0.28);
            border-radius: 9px;
            background: rgba(248, 113, 113, 0.05);
            color: var(--error);
            font-family: var(--font-body);
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--t);
            margin-top: 6px;
        }

        .btn-reset:hover {
            background: rgba(248, 113, 113, 0.09);
            border-color: rgba(248, 113, 113, 0.48);
        }

        /* Responsive */
        @media (max-width: 680px) {
            body {
                align-items: flex-start;
                overflow-y: auto;
            }

            .scene {
                grid-template-columns: 1fr;
                border-radius: 0;
                min-height: 100vh;
                width: 100vw;
            }

            .panel-left {
                display: none;
            }

            .panel-right {
                padding: 40px 26px;
                min-height: 100vh;
            }

            .settings-panel {
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <a href="#login-email" class="skip-link">Skip to form</a>
    <div id="global-live" aria-live="polite" aria-atomic="true" class="sr-only"></div>

    <div class="bg-blobs" aria-hidden="true">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>
    <div class="grid-overlay" aria-hidden="true"></div>

    <!-- Settings Trigger -->
    <button class="settings-trigger" onclick="openSettings()" aria-label="Open preferences" title="Preferences">
        <svg width="19" height="19" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7"
            stroke-linecap="round" stroke-linejoin="round" style="color:#38bdf8">
            <circle cx="12" cy="12" r="3" />
            <path
                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z" />
        </svg>
    </button>

    <!-- Settings Overlay & Panel -->
    <div class="settings-overlay" id="settings-overlay" onclick="closeSettings()"></div>
    <aside class="settings-panel" id="settings-panel" role="dialog" aria-label="Preferences">
        <div class="settings-header">
            <span class="settings-title">⚙ Preferences</span>
            <button class="settings-close" onclick="closeSettings()" aria-label="Close">
                <svg width="13" height="13" viewBox="0 0 13 13" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round">
                    <path d="M1 1l11 11M12 1L1 12" />
                </svg>
            </button>
        </div>
        <div class="s-section">
            <div class="s-section-title">Color Theme</div>
            <div class="theme-grid">
                <div class="theme-swatch active" data-theme="default" onclick="setTheme('default',this)">
                    <div class="swatch-preview">
                        <div class="swatch-dot" style="background:#38bdf8"></div>
                        <div class="swatch-dot" style="background:#a78bfa"></div>
                    </div>
                    <div class="swatch-name">Cyber Blue</div>
                    <div class="swatch-sub">Default</div>
                </div>
                <div class="theme-swatch" data-theme="emerald" onclick="setTheme('emerald',this)">
                    <div class="swatch-preview">
                        <div class="swatch-dot" style="background:#34d399"></div>
                        <div class="swatch-dot" style="background:#06b6d4"></div>
                    </div>
                    <div class="swatch-name">Emerald</div>
                    <div class="swatch-sub">Nature</div>
                </div>
                <div class="theme-swatch" data-theme="rose" onclick="setTheme('rose',this)">
                    <div class="swatch-preview">
                        <div class="swatch-dot" style="background:#f472b6"></div>
                        <div class="swatch-dot" style="background:#fb7185"></div>
                    </div>
                    <div class="swatch-name">Rose</div>
                    <div class="swatch-sub">Vibrant</div>
                </div>
                <div class="theme-swatch" data-theme="amber" onclick="setTheme('amber',this)">
                    <div class="swatch-preview">
                        <div class="swatch-dot" style="background:#fbbf24"></div>
                        <div class="swatch-dot" style="background:#f97316"></div>
                    </div>
                    <div class="swatch-name">Amber</div>
                    <div class="swatch-sub">Warm</div>
                </div>
            </div>
        </div>
        <div class="s-section">
            <div class="s-section-title">Font Family</div>
            <div class="font-options">
                <div class="font-option active" data-font="default" onclick="setFont('default',this)">
                    <div class="font-option-name">DM Sans</div>
                    <div class="font-option-sub">Clean, modern geometric</div>
                </div>
                <div class="font-option" data-font="lexend" onclick="setFont('lexend',this)">
                    <div class="font-option-name" style="font-family:'Lexend',sans-serif">Lexend</div>
                    <div class="font-option-sub">Enhanced readability</div>
                </div>
                <div class="font-option" data-font="mono" onclick="setFont('mono',this)">
                    <div class="font-option-name" style="font-family:'Space Mono',monospace">Space Mono</div>
                    <div class="font-option-sub">Monospaced / Dev</div>
                </div>
                <div class="font-option" data-font="dyslexia" onclick="setFont('dyslexia',this)">
                    <div class="font-option-name" style="font-family:'Atkinson Hyperlegible',sans-serif">Atkinson</div>
                    <div class="font-option-sub">Dyslexia-friendly ✦</div>
                </div>
            </div>
        </div>
        <div class="s-section">
            <div class="s-section-title">Font Size</div>
            <div class="size-options">
                <button class="size-btn" data-size="sm" onclick="setSize('sm',this)">A−<br><span
                        style="font-size:.62rem;font-weight:400;opacity:.6">Small</span></button>
                <button class="size-btn active" data-size="md" onclick="setSize('md',this)">A<br><span
                        style="font-size:.62rem;font-weight:400;opacity:.6">Default</span></button>
                <button class="size-btn" data-size="lg" onclick="setSize('lg',this)">A+<br><span
                        style="font-size:.62rem;font-weight:400;opacity:.6">Large</span></button>
                <button class="size-btn" data-size="xl" onclick="setSize('xl',this)">A++<br><span
                        style="font-size:.62rem;font-weight:400;opacity:.6">XL</span></button>
            </div>
        </div>
        <div class="s-section">
            <div class="s-section-title">Display</div>
            <div class="toggle-row">
                <div>
                    <div class="toggle-lbl">Focus Mode</div>
                    <div class="toggle-sub">Reduce background motion</div>
                </div>
                <label class="toggle-switch"><input type="checkbox" id="tgl-focus" onchange="toggleFocus(this)"><span
                        class="toggle-track"></span></label>
            </div>
            <div class="toggle-row">
                <div>
                    <div class="toggle-lbl">Reduce Motion</div>
                    <div class="toggle-sub">Disable animations</div>
                </div>
                <label class="toggle-switch"><input type="checkbox" id="tgl-motion" onchange="toggleMotion(this)"><span
                        class="toggle-track"></span></label>
            </div>
            <div class="toggle-row">
                <div>
                    <div class="toggle-lbl">High Contrast</div>
                    <div class="toggle-sub">Increased border visibility</div>
                </div>
                <label class="toggle-switch"><input type="checkbox" id="tgl-contrast"
                        onchange="toggleContrast(this)"><span class="toggle-track"></span></label>
            </div>
        </div>
        <button class="btn-reset" onclick="resetAll()">↺ Reset to Defaults</button>
    </aside>

    <!-- MAIN SCENE -->
    <main class="scene" role="main">
        <!-- LEFT PANEL -->
        <div class="panel-left" aria-hidden="true">
            <canvas id="neural-canvas"></canvas>
            <div class="pulse-rings">
                <div class="pulse-ring"></div>
                <div class="pulse-ring"></div>
                <div class="pulse-ring"></div>
            </div>
            <div class="brain-icon">
                <svg width="32" height="32" viewBox="0 0 36 36" fill="none">
                    <path
                        d="M12 10C8 10 5 13 5 17c0 3 2 5.5 5 6.5C9 24.5 8 26 8 28c0 3.5 2.5 6 6 6h8c3.5 0 6-2.5 6-6 0-2-1-3.5-2-4.5 3-1 5-3.5 5-6.5 0-4-3-7-7-7-1-2-3-3-6-3-3 0-5 1-6 3z"
                        stroke="white" stroke-width="1.6" fill="none" stroke-linejoin="round" />
                    <path d="M12 16q3-2 6 0q3 2 6-2" stroke="white" stroke-width="1.4" fill="none"
                        stroke-linecap="round" />
                    <path d="M11 22q3-2 7 0q4 2 7-2" stroke="white" stroke-width="1.4" fill="none"
                        stroke-linecap="round" />
                    <path d="M14 28q2-2 4 0q2 2 4 0" stroke="white" stroke-width="1.4" fill="none"
                        stroke-linecap="round" />
                    <circle cx="18" cy="7" r="1.5" fill="white" opacity="0.8" />
                    <path d="M18 7v3" stroke="white" stroke-width="1.4" />
                </svg>
            </div>
            <canvas id="eeg-canvas"></canvas>
            <div class="data-chips">
                <div class="chip chip-1"><span class="dot" style="background:#38bdf8"></span>Neural Active</div>
                <div class="chip chip-2"><span class="dot" style="background:#a78bfa"></span>WCAG 2.1 AA</div>
                <div class="chip chip-3"><span class="dot" style="background:#34d399"></span>Dyslexia Safe</div>
                <div class="chip chip-4"><span class="dot" style="background:#fbbf24"></span>500+ Books</div>
            </div>
            <div class="left-text">
                <p class="left-tagline">Reading reimagined for <em>every mind.</em></p>
                <p class="left-desc">NeuroRead adapts to how your brain works — not the other way around. Beautifully
                    accessible. Deeply personal.</p>
                <div class="left-stats">
                    <div>
                        <div class="stat-num">98%</div>
                        <div class="stat-lbl">Satisfaction</div>
                    </div>
                    <div>
                        <div class="stat-num">4.9★</div>
                        <div class="stat-lbl">Rating</div>
                    </div>
                    <div>
                        <div class="stat-num">0 ads</div>
                        <div class="stat-lbl">Always</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- RIGHT PANEL -->
        <section class="panel-right" aria-label="Authentication">
            <div>
                <div class="logo" data-text="NeuroRead" aria-label="NeuroRead">
                    <span class="logo-neuro">Neuro</span><span class="logo-read">Read</span><span
                        class="logo-badge">Beta</span>
                </div>
                <p class="logo-sub">Your adaptive reading companion</p>
            </div>

            <div class="api-status">
                <span class="api-dot" id="api-dot"></span>
                <span id="api-status-text">Checking server…</span>
            </div>

            <div id="form-alert" role="alert" aria-live="polite" class="form-alert"></div>

            <div class="tab-row" role="tablist" aria-label="Sign in or register">
                <button class="tab-btn" role="tab" id="tab-login" aria-selected="true" aria-controls="form-login"
                    onclick="switchTab('login')">Sign In</button>
                <button class="tab-btn" role="tab" id="tab-reg" aria-selected="false" aria-controls="form-reg"
                    onclick="switchTab('reg')">Register</button>
            </div>

            <!-- ── LOGIN FORM ── -->
            <form class="auth-form active" id="form-login" novalidate>
                <div class="field">
                    <label for="login-email">Email</label>
                    <div class="field-wrap">
                        <input type="email" id="login-email" autocomplete="email" required aria-required="true"
                            aria-describedby="login-email-e" placeholder="you@example.com" />
                        <span class="input-icon" aria-hidden="true">
                            <svg width="15" height="15" viewBox="0 0 16 16" fill="none">
                                <rect x="1" y="3" width="14" height="10" rx="2" stroke="currentColor"
                                    stroke-width="1.5" />
                                <path d="M1 5.5l7 4.5 7-4.5" stroke="currentColor" stroke-width="1.5"
                                    stroke-linecap="round" />
                            </svg>
                        </span>
                    </div>
                    <div class="field-err" id="login-email-e" role="alert">
                        <svg width="12" height="12" viewBox="0 0 13 13" fill="none">
                            <circle cx="6.5" cy="6.5" r="6" stroke="currentColor" stroke-width="1.4" />
                            <path d="M6.5 4v3M6.5 9h.01" stroke="currentColor" stroke-width="1.4"
                                stroke-linecap="round" />
                        </svg><span></span>
                    </div>
                </div>
                <div class="field">
                    <label for="login-pw">Password</label>
                    <div class="field-wrap">
                        <input type="password" id="login-pw" autocomplete="current-password" required
                            aria-required="true" aria-describedby="login-pw-e" placeholder="••••••••••" />
                        <button type="button" class="toggle-pw-btn" aria-label="Show password"
                            onclick="togglePw('login-pw',this)">
                            <svg width="15" height="15" viewBox="0 0 16 16" fill="none">
                                <ellipse cx="8" cy="8" rx="7" ry="4.5" stroke="currentColor" stroke-width="1.4" />
                                <circle cx="8" cy="8" r="2" stroke="currentColor" stroke-width="1.4" />
                            </svg>
                        </button>
                    </div>
                    <div class="field-err" id="login-pw-e" role="alert">
                        <svg width="12" height="12" viewBox="0 0 13 13" fill="none">
                            <circle cx="6.5" cy="6.5" r="6" stroke="currentColor" stroke-width="1.4" />
                            <path d="M6.5 4v3M6.5 9h.01" stroke="currentColor" stroke-width="1.4"
                                stroke-linecap="round" />
                        </svg><span></span>
                    </div>
                </div>
                <div class="form-meta">
                    <button type="button" class="link-subtle" onclick="forgotPw()">Forgot password?</button>
                </div>
                <button type="submit" class="btn-submit" id="login-submit">
                    <div class="spinner" aria-hidden="true"></div>
                    <span class="btn-label">Sign In</span>
                    <svg width="15" height="15" viewBox="0 0 16 16" fill="none">
                        <path d="M3 8h10M9 4l4 4-4 4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"
                            stroke-linejoin="round" />
                    </svg>
                </button>
                <div class="switch-row">No account? <a role="button" tabindex="0" onclick="switchTab('reg')"
                        onkeydown="if(event.key==='Enter')switchTab('reg')">Create one free →</a></div>
            </form>

            <!-- ── REGISTER FORM ── -->
            <form class="auth-form" id="form-reg" novalidate>
                <div class="field">
                    <label for="reg-name">Full Name</label>
                    <div class="field-wrap">
                        <input type="text" id="reg-name" autocomplete="name" required aria-required="true"
                            aria-describedby="reg-name-e" placeholder="Jane Doe" />
                        <span class="input-icon" aria-hidden="true">
                            <svg width="15" height="15" viewBox="0 0 16 16" fill="none">
                                <circle cx="8" cy="5" r="3" stroke="currentColor" stroke-width="1.4" />
                                <path d="M2 14c0-3.3 2.7-6 6-6s6 2.7 6 6" stroke="currentColor" stroke-width="1.4"
                                    stroke-linecap="round" />
                            </svg>
                        </span>
                    </div>
                    <div class="field-err" id="reg-name-e" role="alert">
                        <svg width="12" height="12" viewBox="0 0 13 13" fill="none">
                            <circle cx="6.5" cy="6.5" r="6" stroke="currentColor" stroke-width="1.4" />
                            <path d="M6.5 4v3M6.5 9h.01" stroke="currentColor" stroke-width="1.4"
                                stroke-linecap="round" />
                        </svg><span></span>
                    </div>
                </div>
                <div class="field">
                    <label for="reg-email">Email</label>
                    <div class="field-wrap">
                        <input type="email" id="reg-email" autocomplete="email" required aria-required="true"
                            aria-describedby="reg-email-e" placeholder="you@example.com" />
                        <span class="input-icon" aria-hidden="true">
                            <svg width="15" height="15" viewBox="0 0 16 16" fill="none">
                                <rect x="1" y="3" width="14" height="10" rx="2" stroke="currentColor"
                                    stroke-width="1.5" />
                                <path d="M1 5.5l7 4.5 7-4.5" stroke="currentColor" stroke-width="1.5"
                                    stroke-linecap="round" />
                            </svg>
                        </span>
                    </div>
                    <div class="field-err" id="reg-email-e" role="alert">
                        <svg width="12" height="12" viewBox="0 0 13 13" fill="none">
                            <circle cx="6.5" cy="6.5" r="6" stroke="currentColor" stroke-width="1.4" />
                            <path d="M6.5 4v3M6.5 9h.01" stroke="currentColor" stroke-width="1.4"
                                stroke-linecap="round" />
                        </svg><span></span>
                    </div>
                </div>
                <div class="field">
                    <label for="reg-pw">Password</label>
                    <div class="field-wrap">
                        <input type="password" id="reg-pw" autocomplete="new-password" required aria-required="true"
                            aria-describedby="reg-pw-e reg-pw-meter" placeholder="Min. 8 characters"
                            oninput="pwStrength(this.value)" />
                        <button type="button" class="toggle-pw-btn" aria-label="Show password"
                            onclick="togglePw('reg-pw',this)">
                            <svg width="15" height="15" viewBox="0 0 16 16" fill="none">
                                <ellipse cx="8" cy="8" rx="7" ry="4.5" stroke="currentColor" stroke-width="1.4" />
                                <circle cx="8" cy="8" r="2" stroke="currentColor" stroke-width="1.4" />
                            </svg>
                        </button>
                    </div>
                    <div class="pw-meter" id="reg-pw-meter" aria-live="polite">
                        <div class="pw-bars">
                            <div class="pw-bar" id="b1"></div>
                            <div class="pw-bar" id="b2"></div>
                            <div class="pw-bar" id="b3"></div>
                            <div class="pw-bar" id="b4"></div>
                        </div>
                        <span class="pw-lbl" id="pw-lbl">Enter a password</span>
                    </div>
                    <div class="field-err" id="reg-pw-e" role="alert">
                        <svg width="12" height="12" viewBox="0 0 13 13" fill="none">
                            <circle cx="6.5" cy="6.5" r="6" stroke="currentColor" stroke-width="1.4" />
                            <path d="M6.5 4v3M6.5 9h.01" stroke="currentColor" stroke-width="1.4"
                                stroke-linecap="round" />
                        </svg><span></span>
                    </div>
                </div>
                <div class="field">
                    <label for="reg-confirm">Confirm Password</label>
                    <div class="field-wrap">
                        <input type="password" id="reg-confirm" autocomplete="new-password" required
                            aria-required="true" aria-describedby="reg-confirm-e" placeholder="Repeat password"
                            oninput="liveConfirm()" />
                        <button type="button" class="toggle-pw-btn" aria-label="Show confirm password"
                            onclick="togglePw('reg-confirm',this)">
                            <svg width="15" height="15" viewBox="0 0 16 16" fill="none">
                                <ellipse cx="8" cy="8" rx="7" ry="4.5" stroke="currentColor" stroke-width="1.4" />
                                <circle cx="8" cy="8" r="2" stroke="currentColor" stroke-width="1.4" />
                            </svg>
                        </button>
                    </div>
                    <div class="field-err" id="reg-confirm-e" role="alert">
                        <svg width="12" height="12" viewBox="0 0 13 13" fill="none">
                            <circle cx="6.5" cy="6.5" r="6" stroke="currentColor" stroke-width="1.4" />
                            <path d="M6.5 4v3M6.5 9h.01" stroke="currentColor" stroke-width="1.4"
                                stroke-linecap="round" />
                        </svg><span></span>
                    </div>
                </div>
                <button type="submit" class="btn-submit" id="reg-submit">
                    <div class="spinner" aria-hidden="true"></div>
                    <span class="btn-label">Create Account</span>
                    <svg width="15" height="15" viewBox="0 0 16 16" fill="none">
                        <path d="M3 8h10M9 4l4 4-4 4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"
                            stroke-linejoin="round" />
                    </svg>
                </button>
                <div class="switch-row">Already a member? <a role="button" tabindex="0" onclick="switchTab('login')"
                        onkeydown="if(event.key==='Enter')switchTab('login')">← Sign in</a></div>
            </form>
        </section>
    </main>

    <script>
        /* ══════ CONFIG ══════ */
        const API_BASE = "http://127.0.0.1:8000/api/auth";

        /* ── Server ping ── */
        (async () => {
            const dot = document.getElementById('api-dot'), txt = document.getElementById('api-status-text');
            try {
                await fetch(`${API_BASE}/`, { method: 'HEAD', signal: AbortSignal.timeout(3000) });
                dot.className = 'api-dot online'; txt.textContent = 'Server connected';
            } catch {
                dot.className = 'api-dot offline'; txt.textContent = 'Server offline';
            }
        })();

        /* ══════ NEURAL CANVAS ══════ */
        (function () {
            const canvas = document.getElementById('neural-canvas');
            const ctx = canvas.getContext('2d');
            let W, H, nodes = [], animating = true;
            class Node {
                constructor() { this.reset(); }
                reset() {
                    this.x = Math.random() * W; this.y = Math.random() * H;
                    this.r = Math.random() * 3 + 1.5; this.vx = (Math.random() - .5) * .3; this.vy = (Math.random() - .5) * .3;
                    this.pulse = Math.random() * Math.PI * 2; this.pulseSpeed = .02 + Math.random() * .03;
                    this.firing = false; this.fireTime = 0; this.nextFire = Math.random() * 300;
                    this.type = Math.random() < .15 ? 'hub' : 'neuron';
                    if (this.type === 'hub') this.r = Math.random() * 5 + 4;
                }
                update() {
                    this.x += this.vx; this.y += this.vy; this.pulse += this.pulseSpeed;
                    if (this.x < -20) this.x = W + 20; if (this.x > W + 20) this.x = -20;
                    if (this.y < -20) this.y = H + 20; if (this.y > H + 20) this.y = -20;
                    this.nextFire--;
                    if (this.nextFire <= 0) { this.firing = true; this.fireTime = 0; this.nextFire = 200 + Math.random() * 400; }
                    if (this.firing) { this.fireTime++; if (this.fireTime > 40) this.firing = false; }
                }
                draw(ctx) {
                    const pulse = .5 + .5 * Math.sin(this.pulse), alpha = .4 + pulse * .6;
                    const r = this.r + (this.firing ? (1 - this.fireTime / 40) * 4 : 0);
                    if (this.type === 'hub') {
                        const g = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, r * 4);
                        g.addColorStop(0, `rgba(56,189,248,${alpha * .28})`); g.addColorStop(1, 'transparent');
                        ctx.beginPath(); ctx.arc(this.x, this.y, r * 4, 0, Math.PI * 2); ctx.fillStyle = g; ctx.fill();
                    }
                    ctx.beginPath(); ctx.arc(this.x, this.y, r, 0, Math.PI * 2);
                    if (this.firing) { const ft = 1 - this.fireTime / 40; ctx.fillStyle = `rgba(56,189,248,${ft})`; ctx.shadowColor = '#38bdf8'; ctx.shadowBlur = 14 * ft; }
                    else { ctx.fillStyle = this.type === 'hub' ? `rgba(167,139,250,${alpha * .9})` : `rgba(56,189,248,${alpha * .7})`; ctx.shadowBlur = 0; }
                    ctx.fill(); ctx.shadowBlur = 0;
                }
            }
            const signals = [];
            class Signal {
                constructor(a, b) { this.from = a; this.to = b; this.p = 0; this.speed = .012 + Math.random() * .015; this.col = Math.random() < .5 ? '56,189,248' : '167,139,250'; }
                update() { this.p += this.speed; return this.p < 1; }
                draw(ctx) {
                    const x = this.from.x + (this.to.x - this.from.x) * this.p, y = this.from.y + (this.to.y - this.from.y) * this.p;
                    const a = Math.sin(this.p * Math.PI);
                    ctx.beginPath(); ctx.arc(x, y, 2.5, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(${this.col},${a})`; ctx.shadowColor = `rgb(${this.col})`; ctx.shadowBlur = 8; ctx.fill(); ctx.shadowBlur = 0;
                }
            }
            function resize() { const el = canvas.parentElement; W = canvas.width = el.offsetWidth; H = canvas.height = el.offsetHeight; }
            function init() { resize(); nodes = Array.from({ length: 55 }, () => new Node()); }
            let sigTimer = 0;
            function draw() {
                if (!animating) return;
                ctx.clearRect(0, 0, W, H);
                for (let i = 0; i < nodes.length; i++) for (let j = i + 1; j < nodes.length; j++) {
                    const a = nodes[i], b = nodes[j], dx = a.x - b.x, dy = a.y - b.y, dist = Math.sqrt(dx * dx + dy * dy);
                    const max = a.type === 'hub' || b.type === 'hub' ? 158 : 108;
                    if (dist < max) {
                        const alpha = (1 - dist / max) * .33; ctx.beginPath(); ctx.moveTo(a.x, a.y); ctx.lineTo(b.x, b.y);
                        const g = ctx.createLinearGradient(a.x, a.y, b.x, b.y); g.addColorStop(0, `rgba(56,189,248,${alpha})`); g.addColorStop(1, `rgba(167,139,250,${alpha})`);
                        ctx.strokeStyle = g; ctx.lineWidth = .8; ctx.stroke();
                    }
                }
                nodes.forEach(n => { n.update(); n.draw(ctx); });
                sigTimer++;
                if (sigTimer > 32) {
                    sigTimer = 0; const firing = nodes.filter(n => n.firing);
                    if (firing.length) {
                        const src = firing[Math.floor(Math.random() * firing.length)]; let best = null, bd = 999;
                        nodes.forEach(n => { if (n === src) return; const dx = n.x - src.x, dy = n.y - src.y, d = Math.sqrt(dx * dx + dy * dy); if (d < 128 && d < bd) { bd = d; best = n; } });
                        if (best) signals.push(new Signal(src, best));
                    }
                }
                for (let i = signals.length - 1; i >= 0; i--) { if (!signals[i].update()) { signals.splice(i, 1); continue; } signals[i].draw(ctx); }
                requestAnimationFrame(draw);
            }
            window.addEventListener('resize', () => { resize(); });
            window.stopNeural = () => { animating = false; ctx.clearRect(0, 0, W, H); };
            window.startNeural = () => { if (!animating) { animating = true; draw(); } };
            init(); draw();
        })();

        /* ══════ EEG CANVAS ══════ */
        (function () {
            const canvas = document.getElementById('eeg-canvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            let t = 0, animating = true;
            function resize() { canvas.width = canvas.offsetWidth * devicePixelRatio || 480; canvas.height = 58; }
            resize(); window.addEventListener('resize', resize);
            function draw() {
                if (!animating) return;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                const W = canvas.width, H = canvas.height; t += .05;
                ctx.beginPath();
                for (let x = 0; x <= W; x++) { const nx = x / W; const y = H / 2 + Math.sin(nx * 12 + t) * 8 + Math.sin(nx * 25 + t * 1.3) * 4 + Math.sin(nx * 50 + t * 2) * 2 + (Math.random() - .5) * 1.5; x === 0 ? ctx.moveTo(x, y) : ctx.lineTo(x, y); }
                const g = ctx.createLinearGradient(0, 0, W, 0);
                g.addColorStop(0, 'rgba(56,189,248,0)'); g.addColorStop(.2, 'rgba(56,189,248,0.8)'); g.addColorStop(.5, 'rgba(167,139,250,0.9)'); g.addColorStop(.8, 'rgba(52,211,153,0.8)'); g.addColorStop(1, 'rgba(52,211,153,0)');
                ctx.strokeStyle = g; ctx.lineWidth = 1.5; ctx.shadowColor = '#38bdf8'; ctx.shadowBlur = 6; ctx.stroke(); ctx.shadowBlur = 0;
                requestAnimationFrame(draw);
            }
            window.stopEEG = () => { animating = false; };
            window.startEEG = () => { if (!animating) { animating = true; draw(); } };
            draw();
        })();

        /* ══════ 3D TILT ══════ */
        (function () {
            const scene = document.querySelector('.scene');
            let bounds;
            const refresh = () => bounds = scene.getBoundingClientRect();
            refresh(); window.addEventListener('resize', refresh);
            document.addEventListener('mousemove', e => {
                if (!bounds) return;
                const x = e.clientX - bounds.left - bounds.width / 2, y = e.clientY - bounds.top - bounds.height / 2;
                scene.style.transform = `perspective(1200px) rotateX(${(y / bounds.height) * -4.5}deg) rotateY(${(x / bounds.width) * 4.5}deg)`;
            });
            document.addEventListener('mouseleave', () => scene.style.transform = 'perspective(1200px) rotateX(0) rotateY(0)');
        })();

        /* ══════ RIPPLE & BURST ══════ */
        const burstCSS = document.createElement('style');
        burstCSS.textContent = '@keyframes burstP{to{transform:translate(var(--tx),var(--ty)) scale(0);opacity:0;}}';
        document.head.appendChild(burstCSS);
        function burst(btn) {
            const colors = ['#38bdf8', '#a78bfa', '#34d399', '#fbbf24'];
            const rect = btn.getBoundingClientRect();
            for (let i = 0; i < 18; i++) {
                const p = document.createElement('span'), a = (i / 18) * Math.PI * 2, d = 55 + Math.random() * 50;
                p.style.cssText = `position:fixed;width:6px;height:6px;border-radius:50%;background:${colors[i % 4]};left:${rect.left + rect.width / 2}px;top:${rect.top + rect.height / 2}px;pointer-events:none;z-index:9999;--tx:${Math.cos(a) * d}px;--ty:${Math.sin(a) * d}px;animation:burstP .8s ${i * .03}s ease forwards;`;
                document.body.appendChild(p); p.addEventListener('animationend', () => p.remove());
            }
        }
        document.querySelectorAll('.btn-submit').forEach(btn => {
            btn.addEventListener('click', function (e) {
                const r = document.createElement('span'); r.className = 'ripple';
                const rect = this.getBoundingClientRect(), sz = Math.max(rect.width, rect.height) * 2;
                r.style.cssText = `width:${sz}px;height:${sz}px;left:${e.clientX - rect.left - sz / 2}px;top:${e.clientY - rect.top - sz / 2}px`;
                this.appendChild(r); r.addEventListener('animationend', () => r.remove());
            });
        });

        /* ══════ TABS ══════ */
        function switchTab(t) {
            ['login', 'reg'].forEach(id => {
                const sel = id === t;
                document.getElementById('tab-' + id).setAttribute('aria-selected', sel);
                document.getElementById('form-' + id).classList.toggle('active', sel);
            });
            document.getElementById('form-alert').className = 'form-alert';
        }

        /* ══════ FORM HELPERS ══════ */
        const validEmail = v => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);
        function setErr(el, errId, msg) { const d = document.getElementById(errId); d.querySelector('span').textContent = msg; d.classList.add('show'); el.setAttribute('aria-invalid', 'true'); }
        function clrErr(el, errId) { document.getElementById(errId).classList.remove('show'); el.setAttribute('aria-invalid', 'false'); }
        function showAlert(type, msg) { const a = document.getElementById('form-alert'); a.textContent = msg; a.className = 'form-alert ' + type; setTimeout(() => { a.className = 'form-alert'; a.textContent = ''; }, 6000); }
        function setLoad(btn, on) { btn.disabled = on; btn.classList.toggle('loading', on); }

        function togglePw(id, btn) {
            const inp = document.getElementById(id), show = inp.type === 'password';
            inp.type = show ? 'text' : 'password';
            btn.setAttribute('aria-label', show ? 'Hide password' : 'Show password');
            btn.innerHTML = show
                ? `<svg width="15" height="15" viewBox="0 0 16 16" fill="none"><ellipse cx="8" cy="8" rx="7" ry="4.5" stroke="currentColor" stroke-width="1.4"/><circle cx="8" cy="8" r="2" stroke="currentColor" stroke-width="1.4"/><line x1="1" y1="1" x2="15" y2="15" stroke="currentColor" stroke-width="1.4"/></svg>`
                : `<svg width="15" height="15" viewBox="0 0 16 16" fill="none"><ellipse cx="8" cy="8" rx="7" ry="4.5" stroke="currentColor" stroke-width="1.4"/><circle cx="8" cy="8" r="2" stroke="currentColor" stroke-width="1.4"/></svg>`;
        }

        function pwStrength(v) {
            let s = 0;
            if (v.length >= 8) s++; if (/[A-Z]/.test(v)) s++; if (/[0-9]/.test(v)) s++; if (/[^A-Za-z0-9]/.test(v)) s++;
            const cls = ['', 'weak', 'fair', 'good', 'strong'], lbl = ['Enter a password', 'Weak', 'Fair', 'Good', 'Strong!'], cols = ['', '#f87171', '#fbbf24', '#38bdf8', '#34d399'];
            for (let i = 1; i <= 4; i++) document.getElementById('b' + i).className = 'pw-bar ' + (v && i <= s ? cls[s] : '');
            const lele = document.getElementById('pw-lbl'); lele.textContent = v ? lbl[s] : lbl[0]; lele.style.color = v ? cols[s] : '';
        }
        function liveConfirm() {
            const pw = document.getElementById('reg-pw').value, cf = document.getElementById('reg-confirm');
            if (cf.value && cf.value !== pw) setErr(cf, 'reg-confirm-e', 'Passwords do not match.');
            else if (cf.value) clrErr(cf, 'reg-confirm-e');
        }
        function forgotPw() { showAlert('success', '✓ If that email exists, a reset link is on its way.'); }

        /* Blur hooks */
        document.getElementById('login-email').addEventListener('blur', function () {
            if (!this.value) setErr(this, 'login-email-e', 'Email is required.');
            else if (!validEmail(this.value)) setErr(this, 'login-email-e', 'Enter a valid email.');
            else clrErr(this, 'login-email-e');
        });
        document.getElementById('login-pw').addEventListener('blur', function () {
            if (!this.value) setErr(this, 'login-pw-e', 'Password is required.');
            else clrErr(this, 'login-pw-e');
        });

        /* ══════ LOGIN ══════ */
        document.getElementById('form-login').addEventListener('submit', async e => {
            e.preventDefault();
            const email = document.getElementById('login-email'), pw = document.getElementById('login-pw');
            let ok = true;
            if (!email.value.trim()) { setErr(email, 'login-email-e', 'Email is required.'); ok = false; }
            else if (!validEmail(email.value)) { setErr(email, 'login-email-e', 'Enter a valid email address.'); ok = false; }
            else clrErr(email, 'login-email-e');
            if (!pw.value) { setErr(pw, 'login-pw-e', 'Password is required.'); ok = false; }
            else clrErr(pw, 'login-pw-e');
            if (!ok) return;
            const btn = document.getElementById('login-submit');
            setLoad(btn, true);
            try {
                const res = await fetch(`${API_BASE}/login/`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ email: email.value.trim(), password: pw.value }) });
                const data = await res.json();
                if (res.ok) {
                    localStorage.setItem('access_token', data.tokens.access);
                    localStorage.setItem('refresh_token', data.tokens.refresh);
                    localStorage.setItem('user_name', data.user.full_name);
                    burst(btn);
                    showAlert('success', `✓ Welcome back, ${data.user.full_name}! Entering NeuroRead…`);
                    e.target.reset();
                    setTimeout(() => window.location.href = 'index.html', 10);
                } else {
                    showAlert('error', '✗ ' + Object.values(data).flat().join(' '));
                }
            } catch {
                showAlert('error', '✗ Network error — is the Django server running?');
            } finally { setLoad(btn, false); }
        });

        /* ══════ REGISTER ══════ */
        document.getElementById('form-reg').addEventListener('submit', async e => {
            e.preventDefault();
            const name = document.getElementById('reg-name'), email = document.getElementById('reg-email'), pw = document.getElementById('reg-pw'), confirm = document.getElementById('reg-confirm');
            let ok = true;
            if (!name.value.trim() || name.value.trim().length < 2) { setErr(name, 'reg-name-e', 'Full name required (min 2 chars).'); ok = false; } else clrErr(name, 'reg-name-e');
            if (!email.value.trim()) { setErr(email, 'reg-email-e', 'Email is required.'); ok = false; } else if (!validEmail(email.value)) { setErr(email, 'reg-email-e', 'Enter a valid email address.'); ok = false; } else clrErr(email, 'reg-email-e');
            if (!pw.value || pw.value.length < 8) { setErr(pw, 'reg-pw-e', 'Password must be at least 8 characters.'); ok = false; } else clrErr(pw, 'reg-pw-e');
            if (!confirm.value) { setErr(confirm, 'reg-confirm-e', 'Please confirm your password.'); ok = false; } else if (confirm.value !== pw.value) { setErr(confirm, 'reg-confirm-e', 'Passwords do not match.'); ok = false; } else clrErr(confirm, 'reg-confirm-e');
            if (!ok) return;
            const btn = document.getElementById('reg-submit');
            setLoad(btn, true);
            try {
                const res = await fetch(`${API_BASE}/register/`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ full_name: name.value.trim(), email: email.value.trim(), password: pw.value, confirm_password: confirm.value, password2: confirm.value }) });
                const data = await res.json();
                if (res.ok) {
                    localStorage.setItem('access_token', data.tokens.access);
                    localStorage.setItem('refresh_token', data.tokens.refresh);
                    burst(btn);
                    showAlert('success', '✓ Account created! Redirecting to login…');
                    e.target.reset(); pwStrength('');
                    setTimeout(() => window.location.href = 'login.html', 1800);
                } else {
                    showAlert('error', '✗ ' + Object.values(data).flat().join(' '));
                }
            } catch {
                showAlert('error', '✗ Network error — is the Django server running?');
            } finally { setLoad(btn, false); }
        });

        /* ══════ SETTINGS ══════ */
        function openSettings() { document.getElementById('settings-panel').classList.add('open'); document.getElementById('settings-overlay').classList.add('open'); }
        function closeSettings() { document.getElementById('settings-panel').classList.remove('open'); document.getElementById('settings-overlay').classList.remove('open'); }
        function setTheme(theme, el) {
            ['emerald', 'rose', 'amber'].forEach(t => document.body.classList.remove('theme-' + t));
            if (theme !== 'default') document.body.classList.add('theme-' + theme);
            document.querySelectorAll('.theme-swatch').forEach(s => s.classList.toggle('active', s.dataset.theme === theme));
        }
        function setFont(font, el) {
            ['lexend', 'mono', 'dyslexia'].forEach(f => document.body.classList.remove('font-' + f));
            if (font !== 'default') document.body.classList.add('font-' + font);
            document.querySelectorAll('.font-option').forEach(o => o.classList.toggle('active', o.dataset.font === font));
        }
        function setSize(size, el) {
            const map = { sm: '13px', md: '16px', lg: '19px', xl: '22px' };
            document.documentElement.style.fontSize = map[size] || '16px';
            document.querySelectorAll('.size-btn').forEach(b => b.classList.toggle('active', b.dataset.size === size));
        }
        function toggleFocus(el) { document.body.classList.toggle('focus', el.checked); }
        function toggleMotion(el) {
            if (el.checked) { window.stopNeural && window.stopNeural(); window.stopEEG && window.stopEEG(); document.body.style.setProperty('--t', '0s'); }
            else { window.startNeural && window.startNeural(); window.startEEG && window.startEEG(); document.body.style.removeProperty('--t'); }
        }
        function toggleContrast(el) {
            if (el.checked) { document.documentElement.style.setProperty('--border', 'rgba(100,180,255,0.42)'); document.documentElement.style.setProperty('--muted', '#a0b8d8'); }
            else { document.documentElement.style.removeProperty('--border'); document.documentElement.style.removeProperty('--muted'); }
        }
        function resetAll() {
            ['emerald', 'rose', 'amber'].forEach(t => document.body.classList.remove('theme-' + t));
            document.querySelectorAll('.theme-swatch').forEach(s => s.classList.toggle('active', s.dataset.theme === 'default'));
            ['lexend', 'mono', 'dyslexia'].forEach(f => document.body.classList.remove('font-' + f));
            document.querySelectorAll('.font-option').forEach(o => o.classList.toggle('active', o.dataset.font === 'default'));
            document.documentElement.style.fontSize = '16px';
            document.querySelectorAll('.size-btn').forEach(b => b.classList.toggle('active', b.dataset.size === 'md'));
            ['tgl-focus', 'tgl-motion', 'tgl-contrast'].forEach(id => {
                const el = document.getElementById(id); if (!el) return; el.checked = false;
                if (id === 'tgl-focus') document.body.classList.remove('focus');
                if (id === 'tgl-motion') { window.startNeural && window.startNeural(); window.startEEG && window.startEEG(); document.body.style.removeProperty('--t'); }
                if (id === 'tgl-contrast') { document.documentElement.style.removeProperty('--border'); document.documentElement.style.removeProperty('--muted'); }
            });
        }

        /* Theme / font CSS vars for dynamic themes */
        const themeStyles = document.createElement('style');
        themeStyles.textContent = `
      body.theme-emerald{--cyan:#34d399;--violet:#06b6d4;}
      body.theme-rose{--cyan:#f472b6;--violet:#fb7185;}
      body.theme-amber{--cyan:#fbbf24;--violet:#f97316;}
      body.font-lexend{--font-body:'Lexend',sans-serif;}
      body.font-mono{--font-body:'Space Mono',monospace;}
      body.font-dyslexia{--font-body:'Atkinson Hyperlegible',sans-serif;letter-spacing:.05em;line-height:1.85;}
      body.focus .bg-blobs,.focus .grid-overlay{opacity:.2;}
    `;
        document.head.appendChild(themeStyles);
    </script>
</body>

</html>